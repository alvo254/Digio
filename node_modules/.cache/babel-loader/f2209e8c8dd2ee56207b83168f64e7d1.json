{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getDomainLocale = getDomainLocale;\nexports.addLocale = addLocale;\nexports.delLocale = delLocale;\nexports.hasBasePath = hasBasePath;\nexports.addBasePath = addBasePath;\nexports.delBasePath = delBasePath;\nexports.isLocalURL = isLocalURL;\nexports.interpolateAs = interpolateAs;\nexports.resolveHref = resolveHref;\nexports.default = void 0;\n\nvar _normalizeTrailingSlash = require(\"../../../client/normalize-trailing-slash\");\n\nvar _routeLoader = require(\"../../../client/route-loader\");\n\nvar _script = require(\"../../../client/script\");\n\nvar _isError = _interopRequireWildcard(require(\"../../../lib/is-error\"));\n\nvar _denormalizePagePath = require(\"../page-path/denormalize-page-path\");\n\nvar _normalizeLocalePath = require(\"../i18n/normalize-locale-path\");\n\nvar _mitt = _interopRequireDefault(require(\"../mitt\"));\n\nvar _utils = require(\"../utils\");\n\nvar _isDynamic = require(\"./utils/is-dynamic\");\n\nvar _parseRelativeUrl = require(\"./utils/parse-relative-url\");\n\nvar _querystring = require(\"./utils/querystring\");\n\nvar _resolveRewrites = _interopRequireDefault(require(\"./utils/resolve-rewrites\"));\n\nvar _routeMatcher = require(\"./utils/route-matcher\");\n\nvar _routeRegex = require(\"./utils/route-regex\");\n\nvar _getMiddlewareRegex = require(\"./utils/get-middleware-regex\");\n\nvar _formatUrl = require(\"./utils/format-url\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\n          var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};\n\n          if (desc.get || desc.set) {\n            Object.defineProperty(newObj, key, desc);\n          } else {\n            newObj[key] = obj[key];\n          }\n        }\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nlet detectDomainLocale;\n\nif (process.env.__NEXT_I18N_SUPPORT) {\n  detectDomainLocale = require('../i18n/detect-domain-locale').detectDomainLocale;\n}\n\nconst basePath = process.env.__NEXT_ROUTER_BASEPATH || '';\n\nfunction buildCancellationError() {\n  return Object.assign(new Error('Route Cancelled'), {\n    cancelled: true\n  });\n}\n\nfunction addPathPrefix(path, prefix) {\n  if (!path.startsWith('/') || !prefix) {\n    return path;\n  }\n\n  const pathname = pathNoQueryHash(path);\n  return (0, _normalizeTrailingSlash).normalizePathTrailingSlash(`${prefix}${pathname}`) + path.slice(pathname.length);\n}\n\nfunction hasPathPrefix(path, prefix) {\n  path = pathNoQueryHash(path);\n  return path === prefix || path.startsWith(prefix + '/');\n}\n\nfunction getDomainLocale(path, locale, locales, domainLocales) {\n  if (process.env.__NEXT_I18N_SUPPORT) {\n    locale = locale || (0, _normalizeLocalePath).normalizeLocalePath(path, locales).detectedLocale;\n    const detectedDomain = detectDomainLocale(domainLocales, undefined, locale);\n\n    if (detectedDomain) {\n      return `http${detectedDomain.http ? '' : 's'}://${detectedDomain.domain}${basePath || ''}${locale === detectedDomain.defaultLocale ? '' : `/${locale}`}${path}`;\n    }\n\n    return false;\n  } else {\n    return false;\n  }\n}\n\nfunction addLocale(path, locale, defaultLocale) {\n  if (process.env.__NEXT_I18N_SUPPORT) {\n    if (locale && locale !== defaultLocale) {\n      const pathname = pathNoQueryHash(path);\n      const pathLower = pathname.toLowerCase();\n      const localeLower = locale.toLowerCase();\n\n      if (!hasPathPrefix(pathLower, '/' + localeLower) && !hasPathPrefix(pathLower, '/api')) {\n        return addPathPrefix(path, '/' + locale);\n      }\n    }\n  }\n\n  return path;\n}\n\nfunction delLocale(path, locale) {\n  if (process.env.__NEXT_I18N_SUPPORT) {\n    const pathname = pathNoQueryHash(path);\n    const pathLower = pathname.toLowerCase();\n    const localeLower = locale && locale.toLowerCase();\n    return locale && (pathLower.startsWith('/' + localeLower + '/') || pathLower === '/' + localeLower) ? (pathname.length === locale.length + 1 ? '/' : '') + path.slice(locale.length + 1) : path;\n  }\n\n  return path;\n}\n\nfunction pathNoQueryHash(path) {\n  const queryIndex = path.indexOf('?');\n  const hashIndex = path.indexOf('#');\n\n  if (queryIndex > -1 || hashIndex > -1) {\n    path = path.substring(0, queryIndex > -1 ? queryIndex : hashIndex);\n  }\n\n  return path;\n}\n\nfunction hasBasePath(path) {\n  return hasPathPrefix(path, basePath);\n}\n\nfunction addBasePath(path) {\n  // we only add the basepath on relative urls\n  return addPathPrefix(path, basePath);\n}\n\nfunction delBasePath(path) {\n  path = path.slice(basePath.length);\n  if (!path.startsWith('/')) path = `/${path}`;\n  return path;\n}\n\nfunction isLocalURL(url) {\n  // prevent a hydration mismatch on href for url with anchor refs\n  if (url.startsWith('/') || url.startsWith('#') || url.startsWith('?')) return true;\n\n  try {\n    // absolute urls can be local if they are on the same origin\n    const locationOrigin = (0, _utils).getLocationOrigin();\n    const resolved = new URL(url, locationOrigin);\n    return resolved.origin === locationOrigin && hasBasePath(resolved.pathname);\n  } catch (_) {\n    return false;\n  }\n}\n\nfunction interpolateAs(route, asPathname, query) {\n  let interpolatedRoute = '';\n  const dynamicRegex = (0, _routeRegex).getRouteRegex(route);\n  const dynamicGroups = dynamicRegex.groups;\n  const dynamicMatches = // Try to match the dynamic route against the asPath\n  (asPathname !== route ? (0, _routeMatcher).getRouteMatcher(dynamicRegex)(asPathname) : '') || // Fall back to reading the values from the href\n  // TODO: should this take priority; also need to change in the router.\n  query;\n  interpolatedRoute = route;\n  const params = Object.keys(dynamicGroups);\n\n  if (!params.every(param => {\n    let value = dynamicMatches[param] || '';\n    const {\n      repeat,\n      optional\n    } = dynamicGroups[param]; // support single-level catch-all\n    // TODO: more robust handling for user-error (passing `/`)\n\n    let replaced = `[${repeat ? '...' : ''}${param}]`;\n\n    if (optional) {\n      replaced = `${!value ? '/' : ''}[${replaced}]`;\n    }\n\n    if (repeat && !Array.isArray(value)) value = [value];\n    return (optional || param in dynamicMatches) && ( // Interpolate group into data URL if present\n    interpolatedRoute = interpolatedRoute.replace(replaced, repeat ? value.map( // these values should be fully encoded instead of just\n    // path delimiter escaped since they are being inserted\n    // into the URL and we expect URL encoded segments\n    // when parsing dynamic route params\n    segment => encodeURIComponent(segment)).join('/') : encodeURIComponent(value)) || '/');\n  })) {\n    interpolatedRoute = '' // did not satisfy all requirements\n    ; // n.b. We ignore this error because we handle warning for this case in\n    // development in the `<Link>` component directly.\n  }\n\n  return {\n    params,\n    result: interpolatedRoute\n  };\n}\n\nfunction omitParmsFromQuery(query, params) {\n  const filteredQuery = {};\n  Object.keys(query).forEach(key => {\n    if (!params.includes(key)) {\n      filteredQuery[key] = query[key];\n    }\n  });\n  return filteredQuery;\n}\n\nfunction resolveHref(router, href, resolveAs) {\n  // we use a dummy base url for relative urls\n  let base;\n  let urlAsString = typeof href === 'string' ? href : (0, _formatUrl).formatWithValidation(href); // repeated slashes and backslashes in the URL are considered\n  // invalid and will never match a Next.js page/file\n\n  const urlProtoMatch = urlAsString.match(/^[a-zA-Z]{1,}:\\/\\//);\n  const urlAsStringNoProto = urlProtoMatch ? urlAsString.slice(urlProtoMatch[0].length) : urlAsString;\n  const urlParts = urlAsStringNoProto.split('?');\n\n  if ((urlParts[0] || '').match(/(\\/\\/|\\\\)/)) {\n    console.error(`Invalid href passed to next/router: ${urlAsString}, repeated forward-slashes (//) or backslashes \\\\ are not valid in the href`);\n    const normalizedUrl = (0, _utils).normalizeRepeatedSlashes(urlAsStringNoProto);\n    urlAsString = (urlProtoMatch ? urlProtoMatch[0] : '') + normalizedUrl;\n  } // Return because it cannot be routed by the Next.js router\n\n\n  if (!isLocalURL(urlAsString)) {\n    return resolveAs ? [urlAsString] : urlAsString;\n  }\n\n  try {\n    base = new URL(urlAsString.startsWith('#') ? router.asPath : router.pathname, 'http://n');\n  } catch (_) {\n    // fallback to / for invalid asPath values e.g. //\n    base = new URL('/', 'http://n');\n  }\n\n  try {\n    const finalUrl = new URL(urlAsString, base);\n    finalUrl.pathname = (0, _normalizeTrailingSlash).normalizePathTrailingSlash(finalUrl.pathname);\n    let interpolatedAs = '';\n\n    if ((0, _isDynamic).isDynamicRoute(finalUrl.pathname) && finalUrl.searchParams && resolveAs) {\n      const query = (0, _querystring).searchParamsToUrlQuery(finalUrl.searchParams);\n      const {\n        result,\n        params\n      } = interpolateAs(finalUrl.pathname, finalUrl.pathname, query);\n\n      if (result) {\n        interpolatedAs = (0, _formatUrl).formatWithValidation({\n          pathname: result,\n          hash: finalUrl.hash,\n          query: omitParmsFromQuery(query, params)\n        });\n      }\n    } // if the origin didn't change, it means we received a relative href\n\n\n    const resolvedHref = finalUrl.origin === base.origin ? finalUrl.href.slice(finalUrl.origin.length) : finalUrl.href;\n    return resolveAs ? [resolvedHref, interpolatedAs || resolvedHref] : resolvedHref;\n  } catch (_1) {\n    return resolveAs ? [urlAsString] : urlAsString;\n  }\n}\n\nfunction stripOrigin(url) {\n  const origin = (0, _utils).getLocationOrigin();\n  return url.startsWith(origin) ? url.substring(origin.length) : url;\n}\n\nfunction prepareUrlAs(router, url, as) {\n  // If url and as provided as an object representation,\n  // we'll format them into the string version here.\n  let [resolvedHref, resolvedAs] = resolveHref(router, url, true);\n  const origin = (0, _utils).getLocationOrigin();\n  const hrefHadOrigin = resolvedHref.startsWith(origin);\n  const asHadOrigin = resolvedAs && resolvedAs.startsWith(origin);\n  resolvedHref = stripOrigin(resolvedHref);\n  resolvedAs = resolvedAs ? stripOrigin(resolvedAs) : resolvedAs;\n  const preparedUrl = hrefHadOrigin ? resolvedHref : addBasePath(resolvedHref);\n  const preparedAs = as ? stripOrigin(resolveHref(router, as)) : resolvedAs || resolvedHref;\n  return {\n    url: preparedUrl,\n    as: asHadOrigin ? preparedAs : addBasePath(preparedAs)\n  };\n}\n\nfunction resolveDynamicRoute(pathname, pages) {\n  const cleanPathname = (0, _normalizeTrailingSlash).removePathTrailingSlash((0, _denormalizePagePath).denormalizePagePath(pathname));\n\n  if (cleanPathname === '/404' || cleanPathname === '/_error') {\n    return pathname;\n  } // handle resolving href for dynamic routes\n\n\n  if (!pages.includes(cleanPathname)) {\n    // eslint-disable-next-line array-callback-return\n    pages.some(page => {\n      if ((0, _isDynamic).isDynamicRoute(page) && (0, _routeRegex).getRouteRegex(page).re.test(cleanPathname)) {\n        pathname = page;\n        return true;\n      }\n    });\n  }\n\n  return (0, _normalizeTrailingSlash).removePathTrailingSlash(pathname);\n}\n\nconst manualScrollRestoration = process.env.__NEXT_SCROLL_RESTORATION && typeof window !== 'undefined' && 'scrollRestoration' in window.history && !!function () {\n  try {\n    let v = '__next'; // eslint-disable-next-line no-sequences\n\n    return sessionStorage.setItem(v, v), sessionStorage.removeItem(v), true;\n  } catch (n) {}\n}();\nconst SSG_DATA_NOT_FOUND = Symbol('SSG_DATA_NOT_FOUND');\n\nfunction fetchRetry(url, attempts, opts) {\n  return fetch(url, {\n    // Cookies are required to be present for Next.js' SSG \"Preview Mode\".\n    // Cookies may also be required for `getServerSideProps`.\n    //\n    // > `fetch` won’t send cookies, unless you set the credentials init\n    // > option.\n    // https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch\n    //\n    // > For maximum browser compatibility when it comes to sending &\n    // > receiving cookies, always supply the `credentials: 'same-origin'`\n    // > option instead of relying on the default.\n    // https://github.com/github/fetch#caveats\n    credentials: 'same-origin'\n  }).then(res => {\n    if (!res.ok) {\n      if (attempts > 1 && res.status >= 500) {\n        return fetchRetry(url, attempts - 1, opts);\n      }\n\n      if (res.status === 404) {\n        return res.json().then(data => {\n          if (data.notFound) {\n            return {\n              notFound: SSG_DATA_NOT_FOUND\n            };\n          }\n\n          throw new Error(`Failed to load static props`);\n        });\n      }\n\n      throw new Error(`Failed to load static props`);\n    }\n\n    return opts.text ? res.text() : res.json();\n  });\n}\n\nfunction fetchNextData(dataHref, isServerRender, text, inflightCache, persistCache) {\n  const {\n    href: cacheKey\n  } = new URL(dataHref, window.location.href);\n\n  if (inflightCache[cacheKey] !== undefined) {\n    return inflightCache[cacheKey];\n  }\n\n  return inflightCache[cacheKey] = fetchRetry(dataHref, isServerRender ? 3 : 1, {\n    text\n  }).catch(err => {\n    // We should only trigger a server-side transition if this was caused\n    // on a client-side transition. Otherwise, we'd get into an infinite\n    // loop.\n    if (!isServerRender) {\n      (0, _routeLoader).markAssetError(err);\n    }\n\n    throw err;\n  }).then(data => {\n    if (!persistCache || process.env.NODE_ENV !== 'production') {\n      delete inflightCache[cacheKey];\n    }\n\n    return data;\n  }).catch(err => {\n    delete inflightCache[cacheKey];\n    throw err;\n  });\n}\n\nclass Router {\n  constructor(pathname1, query1, as1, _ref) {\n    let {\n      initialProps,\n      pageLoader,\n      App,\n      wrapApp,\n      Component,\n      err,\n      subscription,\n      isFallback,\n      locale,\n      locales,\n      defaultLocale,\n      domainLocales,\n      isPreview,\n      isRsc\n    } = _ref;\n    // Static Data Cache\n    this.sdc = {}; // In-flight Server Data Requests, for deduping\n\n    this.sdr = {}; // In-flight middleware preflight requests\n\n    this.sde = {};\n    this._idx = 0;\n\n    this.onPopState = e => {\n      const state = e.state;\n\n      if (!state) {\n        // We get state as undefined for two reasons.\n        //  1. With older safari (< 8) and older chrome (< 34)\n        //  2. When the URL changed with #\n        //\n        // In the both cases, we don't need to proceed and change the route.\n        // (as it's already changed)\n        // But we can simply replace the state with the new changes.\n        // Actually, for (1) we don't need to nothing. But it's hard to detect that event.\n        // So, doing the following for (1) does no harm.\n        const {\n          pathname,\n          query\n        } = this;\n        this.changeState('replaceState', (0, _formatUrl).formatWithValidation({\n          pathname: addBasePath(pathname),\n          query\n        }), (0, _utils).getURL());\n        return;\n      }\n\n      if (!state.__N) {\n        return;\n      }\n\n      let forcedScroll;\n      const {\n        url,\n        as,\n        options,\n        idx\n      } = state;\n\n      if (process.env.__NEXT_SCROLL_RESTORATION) {\n        if (manualScrollRestoration) {\n          if (this._idx !== idx) {\n            // Snapshot current scroll position:\n            try {\n              sessionStorage.setItem('__next_scroll_' + this._idx, JSON.stringify({\n                x: self.pageXOffset,\n                y: self.pageYOffset\n              }));\n            } catch {} // Restore old scroll position:\n\n\n            try {\n              const v = sessionStorage.getItem('__next_scroll_' + idx);\n              forcedScroll = JSON.parse(v);\n            } catch {\n              forcedScroll = {\n                x: 0,\n                y: 0\n              };\n            }\n          }\n        }\n      }\n\n      this._idx = idx;\n      const {\n        pathname\n      } = (0, _parseRelativeUrl).parseRelativeUrl(url); // Make sure we don't re-render on initial load,\n      // can be caused by navigating back from an external site\n\n      if (this.isSsr && as === addBasePath(this.asPath) && pathname === addBasePath(this.pathname)) {\n        return;\n      } // If the downstream application returns falsy, return.\n      // They will then be responsible for handling the event.\n\n\n      if (this._bps && !this._bps(state)) {\n        return;\n      }\n\n      this.change('replaceState', url, as, Object.assign({}, options, {\n        shallow: options.shallow && this._shallow,\n        locale: options.locale || this.defaultLocale\n      }), forcedScroll);\n    }; // represents the current component key\n\n\n    const route = (0, _normalizeTrailingSlash).removePathTrailingSlash(pathname1); // set up the component cache (by route keys)\n\n    this.components = {}; // We should not keep the cache, if there's an error\n    // Otherwise, this cause issues when when going back and\n    // come again to the errored page.\n\n    if (pathname1 !== '/_error') {\n      this.components[route] = {\n        Component,\n        initial: true,\n        props: initialProps,\n        err,\n        __N_SSG: initialProps && initialProps.__N_SSG,\n        __N_SSP: initialProps && initialProps.__N_SSP,\n        __N_RSC: !!isRsc\n      };\n    }\n\n    this.components['/_app'] = {\n      Component: App,\n      styleSheets: []\n    }; // Backwards compat for Router.router.events\n    // TODO: Should be remove the following major version as it was never documented\n\n    this.events = Router.events;\n    this.pageLoader = pageLoader; // if auto prerendered and dynamic route wait to update asPath\n    // until after mount to prevent hydration mismatch\n\n    const autoExportDynamic = (0, _isDynamic).isDynamicRoute(pathname1) && self.__NEXT_DATA__.autoExport;\n\n    this.basePath = basePath;\n    this.sub = subscription;\n    this.clc = null;\n    this._wrapApp = wrapApp; // make sure to ignore extra popState in safari on navigating\n    // back from external site\n\n    this.isSsr = true;\n    this.isLocaleDomain = false;\n    this.isReady = !!(self.__NEXT_DATA__.gssp || self.__NEXT_DATA__.gip || self.__NEXT_DATA__.appGip && !self.__NEXT_DATA__.gsp || !autoExportDynamic && !self.location.search && !process.env.__NEXT_HAS_REWRITES);\n\n    if (process.env.__NEXT_I18N_SUPPORT) {\n      this.locales = locales;\n      this.defaultLocale = defaultLocale;\n      this.domainLocales = domainLocales;\n      this.isLocaleDomain = !!detectDomainLocale(domainLocales, self.location.hostname);\n    }\n\n    this.state = {\n      route,\n      pathname: pathname1,\n      query: query1,\n      asPath: autoExportDynamic ? pathname1 : as1,\n      isPreview: !!isPreview,\n      locale: process.env.__NEXT_I18N_SUPPORT ? locale : undefined,\n      isFallback\n    };\n\n    if (typeof window !== 'undefined') {\n      // make sure \"as\" doesn't start with double slashes or else it can\n      // throw an error as it's considered invalid\n      if (!as1.startsWith('//')) {\n        // in order for `e.state` to work on the `onpopstate` event\n        // we have to register the initial route upon initialization\n        const options = {\n          locale\n        };\n        options._shouldResolveHref = as1 !== pathname1;\n        this.changeState('replaceState', (0, _formatUrl).formatWithValidation({\n          pathname: addBasePath(pathname1),\n          query: query1\n        }), (0, _utils).getURL(), options);\n      }\n\n      window.addEventListener('popstate', this.onPopState); // enable custom scroll restoration handling when available\n      // otherwise fallback to browser's default handling\n\n      if (process.env.__NEXT_SCROLL_RESTORATION) {\n        if (manualScrollRestoration) {\n          window.history.scrollRestoration = 'manual';\n        }\n      }\n    }\n  }\n\n  reload() {\n    window.location.reload();\n  }\n  /**\n  * Go back in history\n  */\n\n\n  back() {\n    window.history.back();\n  }\n  /**\n  * Performs a `pushState` with arguments\n  * @param url of the route\n  * @param as masks `url` for the browser\n  * @param options object you can define `shallow` and other options\n  */\n\n\n  push(url, as) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (process.env.__NEXT_SCROLL_RESTORATION) {\n      // TODO: remove in the future when we update history before route change\n      // is complete, as the popstate event should handle this capture.\n      if (manualScrollRestoration) {\n        try {\n          // Snapshot scroll position right before navigating to a new page:\n          sessionStorage.setItem('__next_scroll_' + this._idx, JSON.stringify({\n            x: self.pageXOffset,\n            y: self.pageYOffset\n          }));\n        } catch {}\n      }\n    }\n\n    ({\n      url,\n      as\n    } = prepareUrlAs(this, url, as));\n    return this.change('pushState', url, as, options);\n  }\n  /**\n  * Performs a `replaceState` with arguments\n  * @param url of the route\n  * @param as masks `url` for the browser\n  * @param options object you can define `shallow` and other options\n  */\n\n\n  replace(url, as) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    ({\n      url,\n      as\n    } = prepareUrlAs(this, url, as));\n    return this.change('replaceState', url, as, options);\n  }\n\n  async change(method, url, as, options, forcedScroll) {\n    if (!isLocalURL(url)) {\n      window.location.href = url;\n      return false;\n    }\n\n    const shouldResolveHref = options._h || options._shouldResolveHref || pathNoQueryHash(url) === pathNoQueryHash(as);\n    const nextState = { ...this.state\n    }; // for static pages with query params in the URL we delay\n    // marking the router ready until after the query is updated\n\n    if (options._h) {\n      this.isReady = true;\n    }\n\n    const prevLocale = nextState.locale;\n\n    if (process.env.__NEXT_I18N_SUPPORT) {\n      nextState.locale = options.locale === false ? this.defaultLocale : options.locale || nextState.locale;\n\n      if (typeof options.locale === 'undefined') {\n        options.locale = nextState.locale;\n      }\n\n      const parsedAs = (0, _parseRelativeUrl).parseRelativeUrl(hasBasePath(as) ? delBasePath(as) : as);\n      const localePathResult = (0, _normalizeLocalePath).normalizeLocalePath(parsedAs.pathname, this.locales);\n\n      if (localePathResult.detectedLocale) {\n        nextState.locale = localePathResult.detectedLocale;\n        parsedAs.pathname = addBasePath(parsedAs.pathname);\n        as = (0, _formatUrl).formatWithValidation(parsedAs);\n        url = addBasePath((0, _normalizeLocalePath).normalizeLocalePath(hasBasePath(url) ? delBasePath(url) : url, this.locales).pathname);\n      }\n\n      let didNavigate = false; // we need to wrap this in the env check again since regenerator runtime\n      // moves this on its own due to the return\n\n      if (process.env.__NEXT_I18N_SUPPORT) {\n        var ref; // if the locale isn't configured hard navigate to show 404 page\n\n        if (!((ref = this.locales) === null || ref === void 0 ? void 0 : ref.includes(nextState.locale))) {\n          parsedAs.pathname = addLocale(parsedAs.pathname, nextState.locale);\n          window.location.href = (0, _formatUrl).formatWithValidation(parsedAs); // this was previously a return but was removed in favor\n          // of better dead code elimination with regenerator runtime\n\n          didNavigate = true;\n        }\n      }\n\n      const detectedDomain = detectDomainLocale(this.domainLocales, undefined, nextState.locale); // we need to wrap this in the env check again since regenerator runtime\n      // moves this on its own due to the return\n\n      if (process.env.__NEXT_I18N_SUPPORT) {\n        // if we are navigating to a domain locale ensure we redirect to the\n        // correct domain\n        if (!didNavigate && detectedDomain && this.isLocaleDomain && self.location.hostname !== detectedDomain.domain) {\n          const asNoBasePath = delBasePath(as);\n          window.location.href = `http${detectedDomain.http ? '' : 's'}://${detectedDomain.domain}${addBasePath(`${nextState.locale === detectedDomain.defaultLocale ? '' : `/${nextState.locale}`}${asNoBasePath === '/' ? '' : asNoBasePath}` || '/')}`; // this was previously a return but was removed in favor\n          // of better dead code elimination with regenerator runtime\n\n          didNavigate = true;\n        }\n      }\n\n      if (didNavigate) {\n        return new Promise(() => {});\n      }\n    }\n\n    if (!options._h) {\n      this.isSsr = false;\n    } // marking route changes as a navigation start entry\n\n\n    if (_utils.ST) {\n      performance.mark('routeChange');\n    }\n\n    const {\n      shallow = false,\n      scroll = true\n    } = options;\n    const routeProps = {\n      shallow\n    };\n\n    if (this._inFlightRoute) {\n      this.abortComponentLoad(this._inFlightRoute, routeProps);\n    }\n\n    as = addBasePath(addLocale(hasBasePath(as) ? delBasePath(as) : as, options.locale, this.defaultLocale));\n    const cleanedAs = delLocale(hasBasePath(as) ? delBasePath(as) : as, nextState.locale);\n    this._inFlightRoute = as;\n    let localeChange = prevLocale !== nextState.locale; // If the url change is only related to a hash change\n    // We should not proceed. We should only change the state.\n    // WARNING: `_h` is an internal option for handing Next.js client-side\n    // hydration. Your app should _never_ use this property. It may change at\n    // any time without notice.\n\n    if (!options._h && this.onlyAHashChange(cleanedAs) && !localeChange) {\n      nextState.asPath = cleanedAs;\n      Router.events.emit('hashChangeStart', as, routeProps); // TODO: do we need the resolved href when only a hash change?\n\n      this.changeState(method, url, as, { ...options,\n        scroll: false\n      });\n\n      if (scroll) {\n        this.scrollToHash(cleanedAs);\n      }\n\n      this.set(nextState, this.components[nextState.route], null);\n      Router.events.emit('hashChangeComplete', as, routeProps);\n      return true;\n    }\n\n    let parsed = (0, _parseRelativeUrl).parseRelativeUrl(url);\n    let {\n      pathname,\n      query\n    } = parsed; // The build manifest needs to be loaded before auto-static dynamic pages\n    // get their query parameters to allow ensuring they can be parsed properly\n    // when rewritten to\n\n    let pages, rewrites;\n\n    try {\n      [pages, {\n        __rewrites: rewrites\n      }] = await Promise.all([this.pageLoader.getPageList(), (0, _routeLoader).getClientBuildManifest(), this.pageLoader.getMiddlewareList()]);\n    } catch (err) {\n      // If we fail to resolve the page list or client-build manifest, we must\n      // do a server-side transition:\n      window.location.href = as;\n      return false;\n    } // If asked to change the current URL we should reload the current page\n    // (not location.reload() but reload getInitialProps and other Next.js stuffs)\n    // We also need to set the method = replaceState always\n    // as this should not go into the history (That's how browsers work)\n    // We should compare the new asPath to the current asPath, not the url\n\n\n    if (!this.urlIsNew(cleanedAs) && !localeChange) {\n      method = 'replaceState';\n    } // we need to resolve the as value using rewrites for dynamic SSG\n    // pages to allow building the data URL correctly\n\n\n    let resolvedAs = as; // url and as should always be prefixed with basePath by this\n    // point by either next/link or router.push/replace so strip the\n    // basePath from the pathname to match the pages dir 1-to-1\n\n    pathname = pathname ? (0, _normalizeTrailingSlash).removePathTrailingSlash(delBasePath(pathname)) : pathname;\n\n    if (shouldResolveHref && pathname !== '/_error') {\n      options._shouldResolveHref = true;\n\n      if (process.env.__NEXT_HAS_REWRITES && as.startsWith('/')) {\n        const rewritesResult = (0, _resolveRewrites).default(addBasePath(addLocale(cleanedAs, nextState.locale)), pages, rewrites, query, p => resolveDynamicRoute(p, pages), this.locales);\n\n        if (rewritesResult.externalDest) {\n          location.href = as;\n          return true;\n        }\n\n        resolvedAs = rewritesResult.asPath;\n\n        if (rewritesResult.matchedPage && rewritesResult.resolvedHref) {\n          // if this directly matches a page we need to update the href to\n          // allow the correct page chunk to be loaded\n          pathname = rewritesResult.resolvedHref;\n          parsed.pathname = addBasePath(pathname);\n          url = (0, _formatUrl).formatWithValidation(parsed);\n        }\n      } else {\n        parsed.pathname = resolveDynamicRoute(pathname, pages);\n\n        if (parsed.pathname !== pathname) {\n          pathname = parsed.pathname;\n          parsed.pathname = addBasePath(pathname);\n          url = (0, _formatUrl).formatWithValidation(parsed);\n        }\n      }\n    }\n\n    if (!isLocalURL(as)) {\n      if (process.env.NODE_ENV !== 'production') {\n        throw new Error(`Invalid href: \"${url}\" and as: \"${as}\", received relative href and external as` + `\\nSee more info: https://nextjs.org/docs/messages/invalid-relative-url-external-as`);\n      }\n\n      window.location.href = as;\n      return false;\n    }\n\n    resolvedAs = delLocale(delBasePath(resolvedAs), nextState.locale);\n    /**\n    * If the route update was triggered for client-side hydration and\n    * the rendered route is not dynamic do not check the preflight\n    * request as it is not necessary.\n    */\n\n    if ((!options.shallow || options._h === 1) && (options._h !== 1 || (0, _isDynamic).isDynamicRoute((0, _normalizeTrailingSlash).removePathTrailingSlash(pathname)))) {\n      const effect = await this._preflightRequest({\n        as,\n        cache: process.env.NODE_ENV === 'production',\n        pages,\n        pathname,\n        query,\n        locale: nextState.locale,\n        isPreview: nextState.isPreview\n      });\n\n      if (effect.type === 'rewrite') {\n        query = { ...query,\n          ...effect.parsedAs.query\n        };\n        resolvedAs = effect.asPath;\n        pathname = effect.resolvedHref;\n        parsed.pathname = effect.resolvedHref;\n        url = (0, _formatUrl).formatWithValidation(parsed);\n      } else if (effect.type === 'redirect' && effect.newAs) {\n        return this.change(method, effect.newUrl, effect.newAs, options);\n      } else if (effect.type === 'redirect' && effect.destination) {\n        window.location.href = effect.destination;\n        return new Promise(() => {});\n      } else if (effect.type === 'refresh' && as !== window.location.pathname) {\n        window.location.href = as;\n        return new Promise(() => {});\n      }\n    }\n\n    const route = (0, _normalizeTrailingSlash).removePathTrailingSlash(pathname);\n\n    if ((0, _isDynamic).isDynamicRoute(route)) {\n      const parsedAs = (0, _parseRelativeUrl).parseRelativeUrl(resolvedAs);\n      const asPathname = parsedAs.pathname;\n      const routeRegex = (0, _routeRegex).getRouteRegex(route);\n      const routeMatch = (0, _routeMatcher).getRouteMatcher(routeRegex)(asPathname);\n      const shouldInterpolate = route === asPathname;\n      const interpolatedAs = shouldInterpolate ? interpolateAs(route, asPathname, query) : {};\n\n      if (!routeMatch || shouldInterpolate && !interpolatedAs.result) {\n        const missingParams = Object.keys(routeRegex.groups).filter(param => !query[param]);\n\n        if (missingParams.length > 0) {\n          if (process.env.NODE_ENV !== 'production') {\n            console.warn(`${shouldInterpolate ? `Interpolating href` : `Mismatching \\`as\\` and \\`href\\``} failed to manually provide ` + `the params: ${missingParams.join(', ')} in the \\`href\\`'s \\`query\\``);\n          }\n\n          throw new Error((shouldInterpolate ? `The provided \\`href\\` (${url}) value is missing query values (${missingParams.join(', ')}) to be interpolated properly. ` : `The provided \\`as\\` value (${asPathname}) is incompatible with the \\`href\\` value (${route}). `) + `Read more: https://nextjs.org/docs/messages/${shouldInterpolate ? 'href-interpolation-failed' : 'incompatible-href-as'}`);\n        }\n      } else if (shouldInterpolate) {\n        as = (0, _formatUrl).formatWithValidation(Object.assign({}, parsedAs, {\n          pathname: interpolatedAs.result,\n          query: omitParmsFromQuery(query, interpolatedAs.params)\n        }));\n      } else {\n        // Merge params into `query`, overwriting any specified in search\n        Object.assign(query, routeMatch);\n      }\n    }\n\n    Router.events.emit('routeChangeStart', as, routeProps);\n\n    try {\n      var ref1, ref2;\n      let routeInfo = await this.getRouteInfo(route, pathname, query, as, resolvedAs, routeProps, nextState.locale, nextState.isPreview);\n      let {\n        error,\n        props,\n        __N_SSG,\n        __N_SSP\n      } = routeInfo;\n      const component = routeInfo.Component;\n\n      if (component && component.unstable_scriptLoader) {\n        const scripts = [].concat(component.unstable_scriptLoader());\n        scripts.forEach(script => {\n          (0, _script).handleClientScriptLoad(script.props);\n        });\n      } // handle redirect on client-transition\n\n\n      if ((__N_SSG || __N_SSP) && props) {\n        if (props.pageProps && props.pageProps.__N_REDIRECT) {\n          const destination = props.pageProps.__N_REDIRECT; // check if destination is internal (resolves to a page) and attempt\n          // client-navigation if it is falling back to hard navigation if\n          // it's not\n\n          if (destination.startsWith('/') && props.pageProps.__N_REDIRECT_BASE_PATH !== false) {\n            const parsedHref = (0, _parseRelativeUrl).parseRelativeUrl(destination);\n            parsedHref.pathname = resolveDynamicRoute(parsedHref.pathname, pages);\n            const {\n              url: newUrl,\n              as: newAs\n            } = prepareUrlAs(this, destination, destination);\n            return this.change(method, newUrl, newAs, options);\n          }\n\n          window.location.href = destination;\n          return new Promise(() => {});\n        }\n\n        nextState.isPreview = !!props.__N_PREVIEW; // handle SSG data 404\n\n        if (props.notFound === SSG_DATA_NOT_FOUND) {\n          let notFoundRoute;\n\n          try {\n            await this.fetchComponent('/404');\n            notFoundRoute = '/404';\n          } catch (_) {\n            notFoundRoute = '/_error';\n          }\n\n          routeInfo = await this.getRouteInfo(notFoundRoute, notFoundRoute, query, as, resolvedAs, {\n            shallow: false\n          }, nextState.locale, nextState.isPreview);\n        }\n      }\n\n      Router.events.emit('beforeHistoryChange', as, routeProps);\n      this.changeState(method, url, as, options);\n\n      if (options._h && pathname === '/_error' && ((ref1 = self.__NEXT_DATA__.props) === null || ref1 === void 0 ? void 0 : (ref2 = ref1.pageProps) === null || ref2 === void 0 ? void 0 : ref2.statusCode) === 500 && (props === null || props === void 0 ? void 0 : props.pageProps)) {\n        // ensure statusCode is still correct for static 500 page\n        // when updating query information\n        props.pageProps.statusCode = 500;\n      } // shallow routing is only allowed for same page URL changes.\n\n\n      const isValidShallowRoute = options.shallow && nextState.route === route;\n\n      var _scroll;\n\n      const shouldScroll = (_scroll = options.scroll) !== null && _scroll !== void 0 ? _scroll : !isValidShallowRoute;\n      const resetScroll = shouldScroll ? {\n        x: 0,\n        y: 0\n      } : null;\n      await this.set({ ...nextState,\n        route,\n        pathname,\n        query,\n        asPath: cleanedAs,\n        isFallback: false\n      }, routeInfo, forcedScroll !== null && forcedScroll !== void 0 ? forcedScroll : resetScroll).catch(e => {\n        if (e.cancelled) error = error || e;else throw e;\n      });\n\n      if (error) {\n        Router.events.emit('routeChangeError', error, cleanedAs, routeProps);\n        throw error;\n      }\n\n      if (process.env.__NEXT_I18N_SUPPORT) {\n        if (nextState.locale) {\n          document.documentElement.lang = nextState.locale;\n        }\n      }\n\n      Router.events.emit('routeChangeComplete', as, routeProps);\n      return true;\n    } catch (err1) {\n      if ((0, _isError).default(err1) && err1.cancelled) {\n        return false;\n      }\n\n      throw err1;\n    }\n  }\n\n  changeState(method, url, as) {\n    let options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof window.history === 'undefined') {\n        console.error(`Warning: window.history is not available.`);\n        return;\n      }\n\n      if (typeof window.history[method] === 'undefined') {\n        console.error(`Warning: window.history.${method} is not available`);\n        return;\n      }\n    }\n\n    if (method !== 'pushState' || (0, _utils).getURL() !== as) {\n      this._shallow = options.shallow;\n      window.history[method]({\n        url,\n        as,\n        options,\n        __N: true,\n        idx: this._idx = method !== 'pushState' ? this._idx : this._idx + 1\n      }, // Most browsers currently ignores this parameter, although they may use it in the future.\n      // Passing the empty string here should be safe against future changes to the method.\n      // https://developer.mozilla.org/en-US/docs/Web/API/History/replaceState\n      '', as);\n    }\n  }\n\n  async handleRouteInfoError(err, pathname, query, as, routeProps, loadErrorFail) {\n    if (err.cancelled) {\n      // bubble up cancellation errors\n      throw err;\n    }\n\n    if ((0, _routeLoader).isAssetError(err) || loadErrorFail) {\n      Router.events.emit('routeChangeError', err, as, routeProps); // If we can't load the page it could be one of following reasons\n      //  1. Page doesn't exists\n      //  2. Page does exist in a different zone\n      //  3. Internal error while loading the page\n      // So, doing a hard reload is the proper way to deal with this.\n\n      window.location.href = as; // Changing the URL doesn't block executing the current code path.\n      // So let's throw a cancellation error stop the routing logic.\n\n      throw buildCancellationError();\n    }\n\n    try {\n      let Component;\n      let styleSheets;\n      let props;\n\n      if (typeof Component === 'undefined' || typeof styleSheets === 'undefined') {\n        ({\n          page: Component,\n          styleSheets\n        } = await this.fetchComponent('/_error'));\n      }\n\n      const routeInfo = {\n        props,\n        Component,\n        styleSheets,\n        err,\n        error: err\n      };\n\n      if (!routeInfo.props) {\n        try {\n          routeInfo.props = await this.getInitialProps(Component, {\n            err,\n            pathname,\n            query\n          });\n        } catch (gipErr) {\n          console.error('Error in error page `getInitialProps`: ', gipErr);\n          routeInfo.props = {};\n        }\n      }\n\n      return routeInfo;\n    } catch (routeInfoErr) {\n      return this.handleRouteInfoError((0, _isError).default(routeInfoErr) ? routeInfoErr : new Error(routeInfoErr + ''), pathname, query, as, routeProps, true);\n    }\n  }\n\n  async getRouteInfo(route, pathname, query, as, resolvedAs, routeProps, locale, isPreview) {\n    try {\n      const existingRouteInfo = this.components[route];\n\n      if (routeProps.shallow && existingRouteInfo && this.route === route) {\n        return existingRouteInfo;\n      }\n\n      let cachedRouteInfo = undefined; // can only use non-initial route info\n      // cannot reuse route info in development since it can change after HMR\n\n      if (process.env.NODE_ENV !== 'development' && existingRouteInfo && !('initial' in existingRouteInfo)) {\n        cachedRouteInfo = existingRouteInfo;\n      }\n\n      const routeInfo = cachedRouteInfo || (await this.fetchComponent(route).then(res => ({\n        Component: res.page,\n        styleSheets: res.styleSheets,\n        __N_SSG: res.mod.__N_SSG,\n        __N_SSP: res.mod.__N_SSP,\n        __N_RSC: !!res.mod.__next_rsc__\n      })));\n      const {\n        Component,\n        __N_SSG,\n        __N_SSP,\n        __N_RSC\n      } = routeInfo;\n\n      if (process.env.NODE_ENV !== 'production') {\n        const {\n          isValidElementType\n        } = require('next/dist/compiled/react-is');\n\n        if (!isValidElementType(Component)) {\n          throw new Error(`The default export is not a React Component in page: \"${pathname}\"`);\n        }\n      }\n\n      let dataHref; // For server components, non-SSR pages will have statically optimized\n      // flight data in a production build.\n      // So only development and SSR pages will always have the real-time\n      // generated and streamed flight data.\n\n      const useStreamedFlightData = (process.env.NODE_ENV !== 'production' || __N_SSP) && __N_RSC;\n\n      if (__N_SSG || __N_SSP || __N_RSC) {\n        dataHref = this.pageLoader.getDataHref({\n          href: (0, _formatUrl).formatWithValidation({\n            pathname,\n            query\n          }),\n          asPath: resolvedAs,\n          ssg: __N_SSG,\n          flight: useStreamedFlightData,\n          locale\n        });\n      }\n\n      const props = await this._getData(() => (__N_SSG || __N_SSP || __N_RSC) && !useStreamedFlightData ? fetchNextData(dataHref, this.isSsr, false, __N_SSG ? this.sdc : this.sdr, !!__N_SSG && !isPreview) : this.getInitialProps(Component, // we provide AppTree later so this needs to be `any`\n      {\n        pathname,\n        query,\n        asPath: as,\n        locale,\n        locales: this.locales,\n        defaultLocale: this.defaultLocale\n      }));\n\n      if (__N_RSC) {\n        if (useStreamedFlightData) {\n          const {\n            data\n          } = await this._getData(() => this._getFlightData(dataHref));\n          props.pageProps = Object.assign(props.pageProps, {\n            __flight__: data\n          });\n        } else {\n          const {\n            __flight__\n          } = props;\n          props.pageProps = Object.assign({}, props.pageProps, {\n            __flight__\n          });\n        }\n      }\n\n      routeInfo.props = props;\n      this.components[route] = routeInfo;\n      return routeInfo;\n    } catch (err) {\n      return this.handleRouteInfoError((0, _isError).getProperError(err), pathname, query, as, routeProps);\n    }\n  }\n\n  set(state, data, resetScroll) {\n    this.state = state;\n    return this.sub(data, this.components['/_app'].Component, resetScroll);\n  }\n  /**\n  * Callback to execute before replacing router state\n  * @param cb callback to be executed\n  */\n\n\n  beforePopState(cb) {\n    this._bps = cb;\n  }\n\n  onlyAHashChange(as) {\n    if (!this.asPath) return false;\n    const [oldUrlNoHash, oldHash] = this.asPath.split('#');\n    const [newUrlNoHash, newHash] = as.split('#'); // Makes sure we scroll to the provided hash if the url/hash are the same\n\n    if (newHash && oldUrlNoHash === newUrlNoHash && oldHash === newHash) {\n      return true;\n    } // If the urls are change, there's more than a hash change\n\n\n    if (oldUrlNoHash !== newUrlNoHash) {\n      return false;\n    } // If the hash has changed, then it's a hash only change.\n    // This check is necessary to handle both the enter and\n    // leave hash === '' cases. The identity case falls through\n    // and is treated as a next reload.\n\n\n    return oldHash !== newHash;\n  }\n\n  scrollToHash(as) {\n    const [, hash = ''] = as.split('#'); // Scroll to top if the hash is just `#` with no value or `#top`\n    // To mirror browsers\n\n    if (hash === '' || hash === 'top') {\n      window.scrollTo(0, 0);\n      return;\n    } // First we check if the element by id is found\n\n\n    const idEl = document.getElementById(hash);\n\n    if (idEl) {\n      idEl.scrollIntoView();\n      return;\n    } // If there's no element with the id, we check the `name` property\n    // To mirror browsers\n\n\n    const nameEl = document.getElementsByName(hash)[0];\n\n    if (nameEl) {\n      nameEl.scrollIntoView();\n    }\n  }\n\n  urlIsNew(asPath) {\n    return this.asPath !== asPath;\n  }\n  /**\n  * Prefetch page code, you may wait for the data during page rendering.\n  * This feature only works in production!\n  * @param url the href of prefetched page\n  * @param asPath the as path of the prefetched page\n  */\n\n\n  async prefetch(url) {\n    let asPath = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : url;\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    let parsed = (0, _parseRelativeUrl).parseRelativeUrl(url);\n    let {\n      pathname,\n      query\n    } = parsed;\n\n    if (process.env.__NEXT_I18N_SUPPORT) {\n      if (options.locale === false) {\n        pathname = (0, _normalizeLocalePath).normalizeLocalePath(pathname, this.locales).pathname;\n        parsed.pathname = pathname;\n        url = (0, _formatUrl).formatWithValidation(parsed);\n        let parsedAs = (0, _parseRelativeUrl).parseRelativeUrl(asPath);\n        const localePathResult = (0, _normalizeLocalePath).normalizeLocalePath(parsedAs.pathname, this.locales);\n        parsedAs.pathname = localePathResult.pathname;\n        options.locale = localePathResult.detectedLocale || this.defaultLocale;\n        asPath = (0, _formatUrl).formatWithValidation(parsedAs);\n      }\n    }\n\n    const pages = await this.pageLoader.getPageList();\n    let resolvedAs = asPath;\n\n    if (process.env.__NEXT_HAS_REWRITES && asPath.startsWith('/')) {\n      let rewrites;\n      ({\n        __rewrites: rewrites\n      } = await (0, _routeLoader).getClientBuildManifest());\n      const rewritesResult = (0, _resolveRewrites).default(addBasePath(addLocale(asPath, this.locale)), pages, rewrites, parsed.query, p => resolveDynamicRoute(p, pages), this.locales);\n\n      if (rewritesResult.externalDest) {\n        return;\n      }\n\n      resolvedAs = delLocale(delBasePath(rewritesResult.asPath), this.locale);\n\n      if (rewritesResult.matchedPage && rewritesResult.resolvedHref) {\n        // if this directly matches a page we need to update the href to\n        // allow the correct page chunk to be loaded\n        pathname = rewritesResult.resolvedHref;\n        parsed.pathname = pathname;\n        url = (0, _formatUrl).formatWithValidation(parsed);\n      }\n    } else {\n      parsed.pathname = resolveDynamicRoute(parsed.pathname, pages);\n\n      if (parsed.pathname !== pathname) {\n        pathname = parsed.pathname;\n        parsed.pathname = pathname;\n        url = (0, _formatUrl).formatWithValidation(parsed);\n      }\n    } // Prefetch is not supported in development mode because it would trigger on-demand-entries\n\n\n    if (process.env.NODE_ENV !== 'production') {\n      return;\n    }\n\n    const effects = await this._preflightRequest({\n      as: addBasePath(asPath),\n      cache: true,\n      pages,\n      pathname,\n      query,\n      locale: this.locale,\n      isPreview: this.isPreview\n    });\n\n    if (effects.type === 'rewrite') {\n      parsed.pathname = effects.resolvedHref;\n      pathname = effects.resolvedHref;\n      query = { ...query,\n        ...effects.parsedAs.query\n      };\n      resolvedAs = effects.asPath;\n      url = (0, _formatUrl).formatWithValidation(parsed);\n    }\n\n    const route = (0, _normalizeTrailingSlash).removePathTrailingSlash(pathname);\n    await Promise.all([this.pageLoader._isSsg(route).then(isSsg => {\n      return isSsg ? fetchNextData(this.pageLoader.getDataHref({\n        href: url,\n        asPath: resolvedAs,\n        ssg: true,\n        locale: typeof options.locale !== 'undefined' ? options.locale : this.locale\n      }), false, false, this.sdc, true) : false;\n    }), this.pageLoader[options.priority ? 'loadPage' : 'prefetch'](route)]);\n  }\n\n  async fetchComponent(route) {\n    let cancelled = false;\n\n    const cancel = this.clc = () => {\n      cancelled = true;\n    };\n\n    const handleCancelled = () => {\n      if (cancelled) {\n        const error = new Error(`Abort fetching component for route: \"${route}\"`);\n        error.cancelled = true;\n        throw error;\n      }\n\n      if (cancel === this.clc) {\n        this.clc = null;\n      }\n    };\n\n    try {\n      const componentResult = await this.pageLoader.loadPage(route);\n      handleCancelled();\n      return componentResult;\n    } catch (err) {\n      handleCancelled();\n      throw err;\n    }\n  }\n\n  _getData(fn) {\n    let cancelled = false;\n\n    const cancel = () => {\n      cancelled = true;\n    };\n\n    this.clc = cancel;\n    return fn().then(data => {\n      if (cancel === this.clc) {\n        this.clc = null;\n      }\n\n      if (cancelled) {\n        const err = new Error('Loading initial props cancelled');\n        err.cancelled = true;\n        throw err;\n      }\n\n      return data;\n    });\n  }\n\n  _getFlightData(dataHref) {\n    // Do not cache RSC flight response since it's not a static resource\n    return fetchNextData(dataHref, true, true, this.sdc, false).then(serialized => {\n      return {\n        data: serialized\n      };\n    });\n  }\n\n  async _preflightRequest(options) {\n    const asPathname = pathNoQueryHash(options.as);\n    const cleanedAs = delLocale(hasBasePath(asPathname) ? delBasePath(asPathname) : asPathname, options.locale);\n    const fns = await this.pageLoader.getMiddlewareList();\n    const requiresPreflight = fns.some(_ref2 => {\n      let [middleware, isSSR] = _ref2;\n      return (0, _routeMatcher).getRouteMatcher((0, _getMiddlewareRegex).getMiddlewareRegex(middleware, !isSSR))(cleanedAs);\n    });\n\n    if (!requiresPreflight) {\n      return {\n        type: 'next'\n      };\n    }\n\n    const preflightHref = addLocale(options.as, options.locale);\n    let preflight;\n\n    try {\n      preflight = await this._getPreflightData({\n        preflightHref,\n        shouldCache: options.cache,\n        isPreview: options.isPreview\n      });\n    } catch (err) {\n      // If preflight request fails, we need to do a hard-navigation.\n      return {\n        type: 'redirect',\n        destination: options.as\n      };\n    }\n\n    if (preflight.rewrite) {\n      // for external rewrites we need to do a hard navigation\n      // to the resource\n      if (!preflight.rewrite.startsWith('/')) {\n        return {\n          type: 'redirect',\n          destination: options.as\n        };\n      }\n\n      const parsed = (0, _parseRelativeUrl).parseRelativeUrl((0, _normalizeLocalePath).normalizeLocalePath(hasBasePath(preflight.rewrite) ? delBasePath(preflight.rewrite) : preflight.rewrite, this.locales).pathname);\n      const fsPathname = (0, _normalizeTrailingSlash).removePathTrailingSlash(parsed.pathname);\n      let matchedPage;\n      let resolvedHref;\n\n      if (options.pages.includes(fsPathname)) {\n        matchedPage = true;\n        resolvedHref = fsPathname;\n      } else {\n        resolvedHref = resolveDynamicRoute(fsPathname, options.pages);\n\n        if (resolvedHref !== parsed.pathname && options.pages.includes(resolvedHref)) {\n          matchedPage = true;\n        }\n      }\n\n      return {\n        type: 'rewrite',\n        asPath: parsed.pathname,\n        parsedAs: parsed,\n        matchedPage,\n        resolvedHref\n      };\n    }\n\n    if (preflight.redirect) {\n      if (preflight.redirect.startsWith('/')) {\n        const cleanRedirect = (0, _normalizeTrailingSlash).removePathTrailingSlash((0, _normalizeLocalePath).normalizeLocalePath(hasBasePath(preflight.redirect) ? delBasePath(preflight.redirect) : preflight.redirect, this.locales).pathname);\n        const {\n          url: newUrl,\n          as: newAs\n        } = prepareUrlAs(this, cleanRedirect, cleanRedirect);\n        return {\n          type: 'redirect',\n          newUrl,\n          newAs\n        };\n      }\n\n      return {\n        type: 'redirect',\n        destination: preflight.redirect\n      };\n    } // For SSR requests, they will be handled like normal pages.\n\n\n    if (preflight.refresh && !preflight.ssr) {\n      return {\n        type: 'refresh'\n      };\n    }\n\n    return {\n      type: 'next'\n    };\n  }\n\n  _getPreflightData(params) {\n    const {\n      preflightHref,\n      shouldCache = false,\n      isPreview\n    } = params;\n    const {\n      href: cacheKey\n    } = new URL(preflightHref, window.location.href);\n\n    if (process.env.NODE_ENV === 'production' && !isPreview && shouldCache && this.sde[cacheKey]) {\n      return Promise.resolve(this.sde[cacheKey]);\n    }\n\n    return fetch(preflightHref, {\n      method: 'HEAD',\n      credentials: 'same-origin',\n      headers: {\n        'x-middleware-preflight': '1'\n      }\n    }).then(res => {\n      if (!res.ok) {\n        throw new Error(`Failed to preflight request`);\n      }\n\n      return {\n        cache: res.headers.get('x-middleware-cache'),\n        redirect: res.headers.get('Location'),\n        refresh: res.headers.has('x-middleware-refresh'),\n        rewrite: res.headers.get('x-middleware-rewrite'),\n        ssr: !!res.headers.get('x-middleware-ssr')\n      };\n    }).then(data => {\n      if (shouldCache && data.cache !== 'no-cache') {\n        this.sde[cacheKey] = data;\n      }\n\n      return data;\n    }).catch(err => {\n      delete this.sde[cacheKey];\n      throw err;\n    });\n  }\n\n  getInitialProps(Component, ctx) {\n    const {\n      Component: App\n    } = this.components['/_app'];\n\n    const AppTree = this._wrapApp(App);\n\n    ctx.AppTree = AppTree;\n    return (0, _utils).loadGetInitialProps(App, {\n      AppTree,\n      Component,\n      router: this,\n      ctx\n    });\n  }\n\n  abortComponentLoad(as, routeProps) {\n    if (this.clc) {\n      Router.events.emit('routeChangeError', buildCancellationError(), as, routeProps);\n      this.clc();\n      this.clc = null;\n    }\n  }\n\n  get route() {\n    return this.state.route;\n  }\n\n  get pathname() {\n    return this.state.pathname;\n  }\n\n  get query() {\n    return this.state.query;\n  }\n\n  get asPath() {\n    return this.state.asPath;\n  }\n\n  get locale() {\n    return this.state.locale;\n  }\n\n  get isFallback() {\n    return this.state.isFallback;\n  }\n\n  get isPreview() {\n    return this.state.isPreview;\n  }\n\n}\n\nexports.default = Router;\nRouter.events = (0, _mitt).default();","map":{"version":3,"mappings":";;;;;QAqIgBA;QAsBAC;QAsBAC;QA0BAC;QAIAC;QAKAC;QASAC;QAgBAC;QA+EAC;;;AAhTT,2BAA0C,sDAA1C;;AAKA,gBAA8B,0CAA9B;;AACgC,WAAwB,oCAAxB;;AACC,YAAuB,4DAAvB;;AACJ,wBAAoC,gDAApC;;AACA,wBAA+B,2CAA/B;;AACnB,SAAS,6CAAT;;AAUV,UAAU,sBAAV;;AACwB,cAAoB,gCAApB;;AACE,qBAA4B,wCAA5B;;AACM,gBAAqB,iCAArB;;AACX,oBAA0B,8DAA1B;;AACI,iBAAuB,mCAAvB;;AACF,eAAqB,iCAArB;;AACK,uBAA8B,0CAA9B;;AACE,cAAoB,gCAApB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DrC,IAAIC,kBAAJ;;AAEA,IAAIC,OAAO,CAACC,GAARD,CAAYE,mBAAhB,EAAqC;EACnCH,kBAAkB,GAChBI,OAAO,CAAC,8BAAD,CAAPA,CAAwCJ,kBAD1CA;AAED;;AAED,MAAMK,QAAQ,GAAIJ,OAAO,CAACC,GAARD,CAAYK,sBAAZL,IAAiD,EAAnE;;SAESM,yBAAyB;EAChC,OAAOC,MAAM,CAACC,MAAPD,CAAc,IAAIE,KAAJ,CAAU,iBAAV,CAAdF,EAA4C;IACjDG,SAAS,EAAE;EADsC,CAA5CH,CAAP;AAGD;;SAEQI,cAAcC,MAAcC,QAAiB;EACpD,IAAE,CAAGD,IAAI,CAACE,UAALF,CAAgB,GAAhBA,CAAH,IAAsB,CAAMC,MAA9B,EAAsC;IACpC,OAAOD,IAAP;EACD;;EACD,MAAMG,QAAQ,GAAGC,eAAe,CAACJ,IAAD,CAAhC;EAEA,OAAM,IACJK,uBADI,EACsBA,0BADtB,CACsB,GAAIJ,MAAM,GAAGE,QAAQ,EAD3C,IAEJH,IAAI,CAACM,KAALN,CAAWG,QAAQ,CAACI,MAApBP,CAFF;AAID;;SAEQQ,cAAcR,MAAcC,QAAgB;EACnDD,IAAI,GAAGI,eAAe,CAACJ,IAAD,CAAtBA;EACA,OAAOA,IAAI,KAAKC,MAATD,IAAmBA,IAAI,CAACE,UAALF,CAAgBC,MAAM,GAAG,GAAzBD,CAA1B;AACD;;SAEetB,gBACdsB,MACAS,QACAC,SACAC,eACA;EACA,IAAIvB,OAAO,CAACC,GAARD,CAAYE,mBAAhB,EAAqC;IACnCmB,MAAM,GAAGA,MAAM,QAAIG,oBAAJ,EAAuBA,mBAAvB,CAAwBZ,IAAxB,EAA8BU,OAA9B,EAAuCG,cAAtDJ;IAEA,MAAMK,cAAc,GAAG3B,kBAAkB,CAACwB,aAAD,EAAgBI,SAAhB,EAA2BN,MAA3B,CAAzC;;IAEA,IAAIK,cAAJ,EAAoB;MAClB,OAAQ,OAAMA,cAAc,CAACE,IAAfF,GAAsB,EAAtBA,GAA2B,GAAI,MAAKA,cAAc,CAACG,MAAM,GACrEzB,QAAQ,IAAI,EAAE,GACbiB,MAAM,KAAKK,cAAc,CAACI,aAA1BT,GAA0C,EAA1CA,GAAgD,IAAGA,MAAM,KAAKT,IAAI,EAFrE;IAGD;;IACD,OAAO,KAAP;EACD,CAXD,MAWO;IACL,OAAO,KAAP;EACD;AACF;;SAEerB,UACdqB,MACAS,QACAS,eACA;EACA,IAAI9B,OAAO,CAACC,GAARD,CAAYE,mBAAhB,EAAqC;IACnC,IAAImB,MAAM,IAAIA,MAAM,KAAKS,aAAzB,EAAwC;MACtC,MAAMf,QAAQ,GAAGC,eAAe,CAACJ,IAAD,CAAhC;MACA,MAAMmB,SAAS,GAAGhB,QAAQ,CAACiB,WAATjB,EAAlB;MACA,MAAMkB,WAAW,GAAGZ,MAAM,CAACW,WAAPX,EAApB;;MAEA,IAAE,CACCD,aAAa,CAACW,SAAD,EAAY,MAAME,WAAlB,CADd,IAC2C,CAC1Cb,aAAa,CAACW,SAAD,EAAY,MAAZ,CAFhB,EAGE;QACA,OAAOpB,aAAa,CAACC,IAAD,EAAO,MAAMS,MAAb,CAApB;MACD;IACF;EACF;;EACD,OAAOT,IAAP;AACD;;SAEepB,UAAUoB,MAAcS,QAAiB;EACvD,IAAIrB,OAAO,CAACC,GAARD,CAAYE,mBAAhB,EAAqC;IACnC,MAAMa,QAAQ,GAAGC,eAAe,CAACJ,IAAD,CAAhC;IACA,MAAMmB,SAAS,GAAGhB,QAAQ,CAACiB,WAATjB,EAAlB;IACA,MAAMkB,WAAW,GAAGZ,MAAM,IAAIA,MAAM,CAACW,WAAPX,EAA9B;IAEA,OAAOA,MAAM,KACVU,SAAS,CAACjB,UAAViB,CAAqB,MAAME,WAAN,GAAoB,GAAzCF,KACCA,SAAS,KAAK,MAAME,WAFX,CAANZ,GAE4B,CAC9BN,QAAQ,CAACI,MAATJ,KAAoBM,MAAM,CAACF,MAAPE,GAAgB,CAApCN,GAAwC,GAAxCA,GAA8C,EADhB,IAE7BH,IAAI,CAACM,KAALN,CAAWS,MAAM,CAACF,MAAPE,GAAgB,CAA3BT,CAJCS,GAKHT,IALJ;EAMD;;EACD,OAAOA,IAAP;AACD;;SAEQI,gBAAgBJ,MAAc;EACrC,MAAMsB,UAAU,GAAGtB,IAAI,CAACuB,OAALvB,CAAa,GAAbA,CAAnB;EACA,MAAMwB,SAAS,GAAGxB,IAAI,CAACuB,OAALvB,CAAa,GAAbA,CAAlB;;EAEA,IAAIsB,UAAU,IAAI,CAAdA,IAAmBE,SAAS,IAAI,CAApC,EAAuC;IACrCxB,IAAI,GAAGA,IAAI,CAACyB,SAALzB,CAAe,CAAfA,EAAkBsB,UAAU,IAAI,CAAdA,GAAkBA,UAAlBA,GAA+BE,SAAjDxB,CAAPA;EACD;;EACD,OAAOA,IAAP;AACD;;SAEenB,YAAYmB,MAAuB;EACjD,OAAOQ,aAAa,CAACR,IAAD,EAAOR,QAAP,CAApB;AACD;;SAEeV,YAAYkB,MAAsB;EAChD;EACA,OAAOD,aAAa,CAACC,IAAD,EAAOR,QAAP,CAApB;AACD;;SAEeT,YAAYiB,MAAsB;EAChDA,IAAI,GAAGA,IAAI,CAACM,KAALN,CAAWR,QAAQ,CAACe,MAApBP,CAAPA;EACA,IAAE,CAAGA,IAAI,CAACE,UAALF,CAAgB,GAAhBA,CAAL,EAA2BA,IAAI,GAAI,IAAGA,IAAI,EAAfA;EAC3B,OAAOA,IAAP;AACD;;SAKehB,WAAW0C,KAAsB;EAC/C;EACA,IAAIA,GAAG,CAACxB,UAAJwB,CAAe,GAAfA,KAAuBA,GAAG,CAACxB,UAAJwB,CAAe,GAAfA,CAAvBA,IAA8CA,GAAG,CAACxB,UAAJwB,CAAe,GAAfA,CAAlD,EACE,OAAO,IAAP;;EACF,IAAI;IACF;IACA,MAAMC,cAAc,OAAGC,MAAH,EAAoBA,iBAApB,EAApB;IACA,MAAMC,QAAQ,GAAG,IAAIC,GAAJ,CAAQJ,GAAR,EAAaC,cAAb,CAAjB;IACA,OAAOE,QAAQ,CAACE,MAATF,KAAoBF,cAApBE,IAAsChD,WAAW,CAACgD,QAAQ,CAAC1B,QAAV,CAAxD;EACD,CALD,CAKE,OAAO6B,CAAP,EAAU;IACV,OAAO,KAAP;EACD;AACF;;SAIe/C,cACdgD,OACAC,YACAC,OACA;EACA,IAAIC,iBAAiB,GAAG,EAAxB;EAEA,MAAMC,YAAY,OAAGC,WAAH,EAAgBA,aAAhB,CAAiBL,KAAjB,CAAlB;EACA,MAAMM,aAAa,GAAGF,YAAY,CAACG,MAAnC;EACA,MAAMC,cAAc,GAClB;GACCP,UAAU,KAAKD,KAAfC,GAAoB,IAAGQ,aAAH,EAAkBA,eAAlB,CAAmBL,YAAnB,EAAiCH,UAAjC,CAApBA,GAAmE,OACpE;EACA;EACAC,KALF;EAOAC,iBAAiB,GAAGH,KAApBG;EACA,MAAMO,MAAM,GAAGhD,MAAM,CAACiD,IAAPjD,CAAY4C,aAAZ5C,CAAf;;EAEA,IAAE,CACCgD,MAAM,CAACE,KAAPF,CAAcG,KAAF,IAAY;IACvB,IAAIC,KAAK,GAAGN,cAAc,CAACK,KAAD,CAAdL,IAAyB,EAArC;IACA,MAAM;MAAEO,MAAF;MAAUC;IAAV,IAAuBV,aAAa,CAACO,KAAD,CAA1C,CAFuB,CAIvB;IACA;;IACA,IAAII,QAAQ,GAAI,IAAGF,MAAM,GAAG,KAAH,GAAW,EAAE,GAAGF,KAAM,GAA/C;;IACA,IAAIG,QAAJ,EAAc;MACZC,QAAQ,OAAOH,KAAP,GAAe,GAAf,GAAqB,EAAG,IAAGG,QAAS,GAA5CA;IACD;;IACD,IAAIF,MAAM,KAAKG,KAAK,CAACC,OAAND,CAAcJ,KAAdI,CAAf,EAAqCJ,KAAK,GAAG,CAACA,KAAD,CAARA;IAErC,OAAM,CACHE,QAAQ,IAAIH,KAAK,IAAIL,cADlB,OAEJ;IACCL,iBAAiB,GAChBA,iBAAiB,CAAEiB,OAAnBjB,CACEc,QADFd,EAEEY,MAAM,GACDD,KAAK,CACHO,GADFP,EAEG;IACA;IACA;IACA;IACCQ,WAAYC,kBAAkB,CAACD,OAAD,CANlCR,EAQEU,IARFV,CAQO,GARPA,CADC,GAUFS,kBAAkB,CAACT,KAAD,CAZxBX,KAaK,GAjBH,CAAN;EAmBD,CA/BAO,CADH,EAiCE;IACAP,iBAAiB,GAAG,EAApBA,CAAuB;IAAvBA,CADA,CAGA;IACA;EACD;;EACD,OAAO;IACLO,MADK;IAELe,MAAM,EAAEtB;EAFH,CAAP;AAID;;SAEQuB,mBAAmBxB,OAAuBQ,QAAkB;EACnE,MAAMiB,aAAa,GAAmB,EAAtC;EAEAjE,MAAM,CAACiD,IAAPjD,CAAYwC,KAAZxC,EAAmBkE,OAAnBlE,CAA4BmE,GAAF,IAAU;IAClC,IAAE,CAAGnB,MAAM,CAACoB,QAAPpB,CAAgBmB,GAAhBnB,CAAL,EAA2B;MACzBiB,aAAa,CAACE,GAAD,CAAbF,GAAqBzB,KAAK,CAAC2B,GAAD,CAA1BF;IACD;EACF,CAJDjE;EAKA,OAAOiE,aAAP;AACD;;SAMe1E,YACd8E,QACAC,MACAC,WACQ;EACR;EACA,IAAIC,IAAJ;EACA,IAAIC,WAAW,GAAG,OAAOH,IAAP,KAAgB,QAAhB,GAA2BA,IAA3B,GAA+B,IAAGI,UAAH,EAAuBA,oBAAvB,CAAwBJ,IAAxB,CAAjD,CAHQ,CAKR;EACA;;EACA,MAAMK,aAAa,GAAGF,WAAW,CAACG,KAAZH,CAAiB,oBAAjBA,CAAtB;EACA,MAAMI,kBAAkB,GAAGF,aAAa,GACpCF,WAAW,CAAC9D,KAAZ8D,CAAkBE,aAAa,CAAC,CAAD,CAAbA,CAAiB/D,MAAnC6D,CADoC,GAEpCA,WAFJ;EAIA,MAAMK,QAAQ,GAAGD,kBAAkB,CAACE,KAAnBF,CAAyB,GAAzBA,CAAjB;;EAEA,IAAE,CAAGC,QAAQ,CAAC,CAAD,CAARA,IAAe,EAAlB,EAAsBF,KAAtB,CAA2B,WAA3B,CAAF,EAA4C;IAC1CI,OAAO,CAACC,KAARD,CACG,uCAAsCP,WAAY,6EADrDO;IAGA,MAAME,aAAa,OAAGC,MAAH,EAA2BA,wBAA3B,CAA4BN,kBAA5B,CAAnB;IACAJ,WAAW,IAAIE,aAAa,GAAGA,aAAa,CAAC,CAAD,CAAhB,GAAsB,EAAvC,IAA6CO,aAAxDT;EACD,CApBO,CAsBR;;;EACA,IAAE,CAAGpF,UAAU,CAACoF,WAAD,CAAf,EAA8B;IAC5B,OAAQF,SAAS,GAAG,CAACE,WAAD,CAAH,GAAmBA,WAApC;EACD;;EAED,IAAI;IACFD,IAAI,GAAG,IAAIrC,GAAJ,CACLsC,WAAW,CAAClE,UAAZkE,CAAuB,GAAvBA,IAA8BJ,MAAM,CAACe,MAArCX,GAA8CJ,MAAM,CAAC7D,QADhD,EAEL,UAFK,CAAPgE;EAID,CALD,CAKE,OAAOnC,CAAP,EAAU;IACV;IACAmC,IAAI,GAAG,IAAIrC,GAAJ,CAAQ,GAAR,EAAa,UAAb,CAAPqC;EACD;;EACD,IAAI;IACF,MAAMa,QAAQ,GAAG,IAAIlD,GAAJ,CAAQsC,WAAR,EAAqBD,IAArB,CAAjB;IACAa,QAAQ,CAAC7E,QAAT6E,GAAiB,IAAG3E,uBAAH,EAA6BA,0BAA7B,CAA8B2E,QAAQ,CAAC7E,QAAvC,CAAjB6E;IACA,IAAIC,cAAc,GAAG,EAArB;;IAEA,IAAE,IACAC,UADA,EACcA,cADd,CACeF,QAAQ,CAAC7E,QADxB,KAEA6E,QAAQ,CAACG,YAFT,IAGAjB,SAHF,EAIE;MACA,MAAM/B,KAAK,OAAGiD,YAAH,EAAyBA,sBAAzB,CAA0BJ,QAAQ,CAACG,YAAnC,CAAX;MAEA,MAAM;QAAEzB,MAAF;QAAUf;MAAV,IAAqB1D,aAAa,CACtC+F,QAAQ,CAAC7E,QAD6B,EAEtC6E,QAAQ,CAAC7E,QAF6B,EAGtCgC,KAHsC,CAAxC;;MAMA,IAAIuB,MAAJ,EAAY;QACVuB,cAAc,OAAGZ,UAAH,EAAuBA,oBAAvB,CAAwB;UACpClE,QAAQ,EAAEuD,MAD0B;UAEpC2B,IAAI,EAAEL,QAAQ,CAACK,IAFqB;UAGpClD,KAAK,EAAEwB,kBAAkB,CAACxB,KAAD,EAAQQ,MAAR;QAHW,CAAxB,CAAdsC;MAKD;IACF,CAzBC,CA2BF;;;IACA,MAAMK,YAAY,GAChBN,QAAQ,CAACjD,MAATiD,KAAoBb,IAAI,CAACpC,MAAzBiD,GACIA,QAAQ,CAACf,IAATe,CAAc1E,KAAd0E,CAAoBA,QAAQ,CAACjD,MAATiD,CAAgBzE,MAApCyE,CADJA,GAEIA,QAAQ,CAACf,IAHf;IAKA,OACEC,SAAS,GAAG,CAACoB,YAAD,EAAeL,cAAc,IAAIK,YAAjC,CAAH,GAAoDA,YAD/D;EAGD,CApCD,CAoCE,OAAOtD,EAAP,EAAU;IACV,OAAQkC,SAAS,GAAG,CAACE,WAAD,CAAH,GAAmBA,WAApC;EACD;AACF;;SAEQmB,YAAY7D,KAAa;EAChC,MAAMK,MAAM,OAAGH,MAAH,EAAoBA,iBAApB,EAAZ;EAEA,OAAOF,GAAG,CAACxB,UAAJwB,CAAeK,MAAfL,IAAyBA,GAAG,CAACD,SAAJC,CAAcK,MAAM,CAACxB,MAArBmB,CAAzBA,GAAwDA,GAA/D;AACD;;SAEQ8D,aAAaxB,QAAoBtC,KAAU+D,IAAU;EAC5D;EACA;EACA,IAAG,CAAEH,YAAF,EAAgBI,UAAhB,IAA8BxG,WAAW,CAAC8E,MAAD,EAAStC,GAAT,EAAc,IAAd,CAA5C;EACA,MAAMK,MAAM,OAAGH,MAAH,EAAoBA,iBAApB,EAAZ;EACA,MAAM+D,aAAa,GAAGL,YAAY,CAACpF,UAAboF,CAAwBvD,MAAxBuD,CAAtB;EACA,MAAMM,WAAW,GAAGF,UAAU,IAAIA,UAAU,CAACxF,UAAXwF,CAAsB3D,MAAtB2D,CAAlC;EAEAJ,YAAY,GAAGC,WAAW,CAACD,YAAD,CAA1BA;EACAI,UAAU,GAAGA,UAAU,GAAGH,WAAW,CAACG,UAAD,CAAd,GAA6BA,UAApDA;EAEA,MAAMG,WAAW,GAAGF,aAAa,GAAGL,YAAH,GAAkBxG,WAAW,CAACwG,YAAD,CAA9D;EACA,MAAMQ,UAAU,GAAGL,EAAE,GACjBF,WAAW,CAACrG,WAAW,CAAC8E,MAAD,EAASyB,EAAT,CAAZ,CADM,GAEjBC,UAAU,IAAIJ,YAFlB;EAIA,OAAO;IACL5D,GAAG,EAAEmE,WADA;IAELJ,EAAE,EAAEG,WAAW,GAAGE,UAAH,GAAgBhH,WAAW,CAACgH,UAAD;EAFrC,CAAP;AAID;;SAEQC,oBAAoB5F,UAAkB6F,OAAiB;EAC9D,MAAMC,aAAa,OAAGC,uBAAH,EAA0BA,uBAA1B,CAA0B,IAACC,oBAAD,EAAoBA,mBAApB,CAAqBhG,QAArB,CAA1B,CAAnB;;EAEA,IAAI8F,aAAa,KAAK,MAAlBA,IAA4BA,aAAa,KAAK,SAAlD,EAA6D;IAC3D,OAAO9F,QAAP;EACD,CAL6D,CAO9D;;;EACA,IAAE,CAAG6F,KAAK,CAACjC,QAANiC,CAAeC,aAAfD,CAAL,EAAqC;IACnC;IACAA,KAAK,CAACI,IAANJ,CAAYK,IAAF,IAAW;MACnB,IAAE,IAAEnB,UAAF,EAAgBA,cAAhB,CAAiBmB,IAAjB,KAAqB,IAAK/D,WAAL,EAAkBA,aAAlB,CAAmB+D,IAAnB,EAAyBC,EAAzB,CAA4BC,IAA5B,CAAiCN,aAAjC,CAAvB,EAAyE;QACvE9F,QAAQ,GAAGkG,IAAXlG;QACA,OAAO,IAAP;MACD;IACF,CALD6F;EAMD;;EACD,OAAM,IAACE,uBAAD,EAAwBA,uBAAxB,CAAyB/F,QAAzB,CAAN;AACD;;AAmED,MAAMqG,uBAAuB,GAC3BpH,OAAO,CAACC,GAARD,CAAYqH,yBAAZrH,IACA,OAAOsH,MAAP,KAAkB,WADlBtH,IAEA,uBAAuBsH,MAAM,CAACC,OAF9BvH,IAEqC,EAClC,YAAY;EACb,IAAI;IACF,IAAIwH,CAAC,GAAG,QAAR,CADE,CAEF;;IACA,OAAOC,cAAc,CAACC,OAAfD,CAAuBD,CAAvBC,EAA0BD,CAA1BC,GAA8BA,cAAc,CAACE,UAAfF,CAA0BD,CAA1BC,CAA9BA,EAA4D,IAAnE;EACD,CAJD,CAIE,OAAOG,CAAP,EAAU,CAAE;AACf,CANE,EAJL;AAYA,MAAMC,kBAAkB,GAAGC,MAAM,CAAC,oBAAD,CAAjC;;SAESC,WACPzF,KACA0F,UACAC,MACc;EACd,OAAOC,KAAK,CAAC5F,GAAD,EAAM;IAChB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA6F,WAAW,EAAE;EAZG,CAAN,CAALD,CAaJE,IAbIF,CAaEG,GAAF,IAAU;IACf,IAAE,CAAGA,GAAG,CAACC,EAAT,EAAa;MACX,IAAIN,QAAQ,GAAG,CAAXA,IAAgBK,GAAG,CAACE,MAAJF,IAAc,GAAlC,EAAuC;QACrC,OAAON,UAAU,CAACzF,GAAD,EAAM0F,QAAQ,GAAG,CAAjB,EAAoBC,IAApB,CAAjB;MACD;;MACD,IAAII,GAAG,CAACE,MAAJF,KAAe,GAAnB,EAAwB;QACtB,OAAOA,GAAG,CAACG,IAAJH,GAAWD,IAAXC,CAAiBI,IAAF,IAAW;UAC/B,IAAIA,IAAI,CAACC,QAAT,EAAmB;YACjB,OAAO;cAAEA,QAAQ,EAAEb;YAAZ,CAAP;UACD;;UACD,MAAM,IAAIpH,KAAJ,CAAW,6BAAX,CAAN;QACD,CALM4H,CAAP;MAMD;;MACD,MAAM,IAAI5H,KAAJ,CAAW,6BAAX,CAAN;IACD;;IACD,OAAOwH,IAAI,CAACU,IAALV,GAAYI,GAAG,CAACM,IAAJN,EAAZJ,GAAyBI,GAAG,CAACG,IAAJH,EAAhC;EACD,CA7BMH,CAAP;AA8BD;;SAEQU,cACPC,UACAC,gBACAH,MACAI,eACAC,cACA;EACA,MAAM;IAAEnE,IAAI,EAAEoE;EAAR,IAAqB,IAAIvG,GAAJ,CAAQmG,QAAR,EAAkBvB,MAAM,CAAC4B,QAAP5B,CAAgBzC,IAAlC,CAA3B;;EAEA,IAAIkE,aAAa,CAACE,QAAD,CAAbF,KAA4BpH,SAAhC,EAA2C;IACzC,OAAOoH,aAAa,CAACE,QAAD,CAApB;EACD;;EACD,OAAQF,aAAa,CAACE,QAAD,CAAbF,GAA0BhB,UAAU,CAC1Cc,QAD0C,EAE1CC,cAAc,GAAG,CAAH,GAAO,CAFqB,EAG1C;IAAEH;EAAF,CAH0C,CAAVZ,CAK/BoB,KAL+BpB,CAKxBqB,GAAF,IAAiB;IACrB;IACA;IACA;IAEA,IAAE,CAAGN,cAAL,EAAqB;UACnBO,cAAcA,eAACD;IAChB;;IACD,MAAMA,GAAN;EACD,CAd+BrB,EAe/BK,IAf+BL,CAezBU,IAAF,IAAW;IACd,IAAE,CAAGO,YAAH,IAAmBhJ,OAAO,CAACC,GAARD,CAAYsJ,QAAZtJ,KAAyB,YAA9C,EAA4D;MAC1D,OAAO+I,aAAa,CAACE,QAAD,CAApB;IACD;;IACD,OAAOR,IAAP;EACD,CApB+BV,EAqB/BoB,KArB+BpB,CAqBxBqB,GAAF,IAAU;IACd,OAAOL,aAAa,CAACE,QAAD,CAApB;IACA,MAAMG,GAAN;EACD,CAxB+BrB,CAAlC;AAyBD;;MAMoBwB,OAAM;cA4CvBxI,WACAgC,QACAsD,WAgCA;IAAA,IA/BA;MACEmD,YADF;MAEEC,UAFF;MAGEC,GAHF;MAIEC,OAJF;MAKEC,SALF;MAMER,GANF;MAOES,YAPF;MAQEC,UARF;MASEzI,MATF;MAUEC,OAVF;MAWEQ,aAXF;MAYEP,aAZF;MAaEwI,SAbF;MAcEC;IAdF,CA+BA;IAvEF;IAPa,KAQbC,GARa,GAQQ,EARR,CA8EX,CArEF;;IATa,KAUbC,GAVa,GAUQ,EAVR,CA8EX,CAnEF;;IAXa,KAYbC,GAZa,GAYuB,EAZvB;IAAA,KAuCLC,IAvCK,GAuCU,CAvCV;;IAAA,KAsLbC,UAtLa,GAsLCC,CAAJ,IAA+B;MACvC,MAAMC,KAAK,GAAGD,CAAC,CAACC,KAAhB;;MAEA,IAAE,CAAGA,KAAL,EAAY;QACV;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,MAAM;UAAExJ,QAAF;UAAYgC;QAAZ,IAAsB,IAA5B;QACA,KAAKyH,WAAL,CACE,cADF,EACgB,IACdvF,UADc,EACMA,oBADN,CACO;UAAElE,QAAQ,EAAErB,WAAW,CAACqB,QAAD,CAAvB;UAAmCgC;QAAnC,CADP,CADhB,EAEiE,IAC/D0H,MAD+D,EACzDA,MADyD,EAFjE;QAKA;MACD;;MAED,IAAE,CAAGF,KAAK,CAACG,GAAX,EAAgB;QACd;MACD;;MAED,IAAIC,YAAJ;MACA,MAAM;QAAErI,GAAF;QAAO+D,EAAP;QAAWuE,OAAX;QAAoBC;MAApB,IAA4BN,KAAlC;;MACA,IAAIvK,OAAO,CAACC,GAARD,CAAYqH,yBAAhB,EAA2C;QACzC,IAAID,uBAAJ,EAA6B;UAC3B,IAAI,KAAKgD,IAAL,KAAcS,GAAlB,EAAuB;YACrB;YACA,IAAI;cACFpD,cAAc,CAACC,OAAfD,CACE,mBAAmB,KAAK2C,IAD1B3C,EAEEqD,IAAI,CAACC,SAALD,CAAe;gBAAEE,CAAC,EAAEC,IAAI,CAACC,WAAV;gBAAuBC,CAAC,EAAEF,IAAI,CAACG;cAA/B,CAAfN,CAFFrD;YAID,CALD,CAKE,MAAM,CAAE,CAPW,CASrB;;;YACA,IAAI;cACF,MAAMD,CAAC,GAAGC,cAAc,CAAC4D,OAAf5D,CAAuB,mBAAmBoD,GAA1CpD,CAAV;cACAkD,YAAY,GAAGG,IAAI,CAACQ,KAALR,CAAWtD,CAAXsD,CAAfH;YACD,CAHD,CAGE,MAAM;cACNA,YAAY,GAAG;gBAAEK,CAAC,EAAE,CAAL;gBAAQG,CAAC,EAAE;cAAX,CAAfR;YACD;UACF;QACF;MACF;;MACD,KAAKP,IAAL,GAAYS,GAAZ;MAEA,MAAM;QAAE9J;MAAF,IAAY,IAAGwK,iBAAH,EAAmBA,gBAAnB,CAAoBjJ,GAApB,CAAlB,CAnDuC,CAqDvC;MACA;;MACA,IACE,KAAKkJ,KAAL,IACAnF,EAAE,KAAK3G,WAAW,CAAC,KAAKiG,MAAN,CADlB,IAEA5E,QAAQ,KAAKrB,WAAW,CAAC,KAAKqB,QAAN,CAH1B,EAIE;QACA;MACD,CA7DsC,CA+DvC;MACA;;;MACA,IAAI,KAAK0K,IAAL,IAAS,CAAK,KAAKA,IAAL,CAAUlB,KAAV,CAAlB,EAAoC;QAClC;MACD;;MAED,KAAKmB,MAAL,CACE,cADF,EAEEpJ,GAFF,EAGE+D,EAHF,EAIE9F,MAAM,CAACC,MAAPD,CAAwD,EAAxDA,EAA4DqK,OAA5DrK,EAAqE;QACnEoL,OAAO,EAAEf,OAAO,CAACe,OAARf,IAAmB,KAAKgB,QADkC;QAEnEvK,MAAM,EAAEuJ,OAAO,CAACvJ,MAARuJ,IAAkB,KAAK9I;MAFoC,CAArEvB,CAJF,EAQEoK,YARF;IAUD,CArQY,CA8EX,CACA;;;IACA,MAAM9H,KAAK,OAAGiE,uBAAH,EAA0BA,uBAA1B,CAA2B/F,SAA3B,CAAX,CAFA,CAIA;;IACA,KAAK8K,UAAL,GAAkB,EAAlB,CALA,CAMA;IACA;IACA;;IACA,IAAI9K,SAAQ,KAAK,SAAjB,EAA4B;MAC1B,KAAK8K,UAAL,CAAgBhJ,KAAhB,IAAyB;QACvB+G,SADuB;QAEvBkC,OAAO,EAAE,IAFc;QAGvBC,KAAK,EAAEvC,YAHgB;QAIvBJ,GAJuB;QAKvB4C,OAAO,EAAExC,YAAY,IAAIA,YAAY,CAACwC,OALf;QAMvBC,OAAO,EAAEzC,YAAY,IAAIA,YAAY,CAACyC,OANf;QAOvBC,OAAO,IAAIlC;MAPY,CAAzB;IASD;;IAED,KAAK6B,UAAL,CAAgB,OAAhB,IAA2B;MACzBjC,SAAS,EAAEF,GADc;MAEzByC,WAAW,EAAE;IAFY,CAA3B,CArBA,CA4BA;IACA;;IACA,KAAKC,MAAL,GAAc7C,MAAM,CAAC6C,MAArB;IAEA,KAAK3C,UAAL,GAAkBA,UAAlB,CAhCA,CAiCA;IACA;;IACA,MAAM4C,iBAAiB,OACrBvG,UADqB,EACPA,cADO,CACN/E,SADM,KACOkK,IAAI,CAACqB,aAALrB,CAAmBsB,UADjD;;IAGA,KAAKnM,QAAL,GAAgBA,QAAhB;IACA,KAAKoM,GAAL,GAAW3C,YAAX;IACA,KAAK4C,GAAL,GAAW,IAAX;IACA,KAAKC,QAAL,GAAgB/C,OAAhB,CAzCA,CA0CA;IACA;;IACA,KAAK6B,KAAL,GAAa,IAAb;IACA,KAAKmB,cAAL,GAAsB,KAAtB;IACA,KAAKC,OAAL,GAAY,GACV3B,IAAI,CAACqB,aAALrB,CAAmB4B,IAAnB5B,IACAA,IAAI,CAACqB,aAALrB,CAAmB6B,GADnB7B,IAECA,IAAI,CAACqB,aAALrB,CAAmB8B,MAAnB9B,IAAyB,CAAKA,IAAI,CAACqB,aAALrB,CAAmB+B,GAFlD/B,IAEqD,CACnDoB,iBADmD,IAClC,CAChBpB,IAAI,CAAC/B,QAAL+B,CAAcgC,MAFoC,IAE9B,CACpBjN,OAAO,CAACC,GAARD,CAAYkN,mBANL,CAAZ;;IASA,IAAIlN,OAAO,CAACC,GAARD,CAAYE,mBAAhB,EAAqC;MACnC,KAAKoB,OAAL,GAAeA,OAAf;MACA,KAAKQ,aAAL,GAAqBA,aAArB;MACA,KAAKP,aAAL,GAAqBA,aAArB;MACA,KAAKoL,cAAL,GAAmB,EAAK5M,kBAAkB,CACxCwB,aADwC,EAExC0J,IAAI,CAAC/B,QAAL+B,CAAckC,QAF0B,CAA1C;IAID;;IAED,KAAK5C,KAAL,GAAa;MACX1H,KADW;MAEX9B,QAAQ,EAARA,SAFW;MAGXgC,KAAK,EAALA,MAHW;MAIX4C,MAAM,EAAE0G,iBAAiB,GAAGtL,SAAH,GAAcsF,GAJ5B;MAKX0D,SAAS,IAAIA,SALF;MAMX1I,MAAM,EAAErB,OAAO,CAACC,GAARD,CAAYE,mBAAZF,GAAkCqB,MAAlCrB,GAA2C2B,SANxC;MAOXmI;IAPW,CAAb;;IAUA,IAAI,OAAOxC,MAAP,KAAkB,WAAtB,EAAmC;MACjC;MACA;MACA,IAAE,CAAGjB,GAAE,CAACvF,UAAHuF,CAAc,IAAdA,CAAL,EAA0B;QACxB;QACA;QACA,MAAMuE,OAAO,GAAsB;UAAEvJ;QAAF,CAAnC;QACEuJ,OAAO,CAASwC,kBAAhBxC,GAAqCvE,GAAE,KAAKtF,SAA5C6J;QAEF,KAAKJ,WAAL,CACE,cADF,EACgB,IACdvF,UADc,EACMA,oBADN,CACO;UAAElE,QAAQ,EAAErB,WAAW,CAACqB,SAAD,CAAvB;UAAmCgC,KAAK,EAALA;QAAnC,CADP,CADhB,EAEiE,IAC/D0H,MAD+D,EACzDA,MADyD,EAFjE,EAIEG,OAJF;MAMD;;MAEDtD,MAAM,CAAC+F,gBAAP/F,CAAwB,UAAxBA,EAAoC,KAAK+C,UAAzC/C,EAjBiC,CAmBjC;MACA;;MACA,IAAItH,OAAO,CAACC,GAARD,CAAYqH,yBAAhB,EAA2C;QACzC,IAAID,uBAAJ,EAA6B;UAC3BE,MAAM,CAACC,OAAPD,CAAegG,iBAAfhG,GAAmC,QAAnCA;QACD;MACF;IACF;EACF;;EAmFDiG,MAAM,GAAS;IACbjG,MAAM,CAAC4B,QAAP5B,CAAgBiG,MAAhBjG;EACD;EAED;;;;;EAGAkG,IAAI,GAAG;IACLlG,MAAM,CAACC,OAAPD,CAAekG,IAAflG;EACD;EAED;;;;;;;;EAMAmG,IAAI,CAACnL,GAAD,EAAW+D,EAAX,EAAsD;IAAA,IAAjCuE,OAAiC,uEAAJ,EAAI;;IACxD,IAAI5K,OAAO,CAACC,GAARD,CAAYqH,yBAAhB,EAA2C;MACzC;MACA;MACA,IAAID,uBAAJ,EAA6B;QAC3B,IAAI;UACF;UACAK,cAAc,CAACC,OAAfD,CACE,mBAAmB,KAAK2C,IAD1B3C,EAEEqD,IAAI,CAACC,SAALD,CAAe;YAAEE,CAAC,EAAEC,IAAI,CAACC,WAAV;YAAuBC,CAAC,EAAEF,IAAI,CAACG;UAA/B,CAAfN,CAFFrD;QAID,CAND,CAME,MAAM,CAAE;MACX;IACF;;KACC;MAAEnF,GAAF;MAAO+D;IAAP,IAAcD,YAAY,CAAC,IAAD,EAAO9D,GAAP,EAAY+D,EAAZ;IAC5B,OAAO,KAAKqF,MAAL,CAAY,WAAZ,EAAyBpJ,GAAzB,EAA8B+D,EAA9B,EAAkCuE,OAAlC,CAAP;EACD;EAED;;;;;;;;EAMA3G,OAAO,CAAC3B,GAAD,EAAW+D,EAAX,EAAsD;IAAA,IAAjCuE,OAAiC,uEAAJ,EAAI;KACzD;MAAEtI,GAAF;MAAO+D;IAAP,IAAcD,YAAY,CAAC,IAAD,EAAO9D,GAAP,EAAY+D,EAAZ;IAC5B,OAAO,KAAKqF,MAAL,CAAY,cAAZ,EAA4BpJ,GAA5B,EAAiC+D,EAAjC,EAAqCuE,OAArC,CAAP;EACD;;EAEmB,MAANc,MAAM,CAClBgC,MADkB,EAElBpL,GAFkB,EAGlB+D,EAHkB,EAIlBuE,OAJkB,EAKlBD,YALkB,EAMA;IAClB,IAAE,CAAG/K,UAAU,CAAC0C,GAAD,CAAf,EAAsB;MACpBgF,MAAM,CAAC4B,QAAP5B,CAAgBzC,IAAhByC,GAAuBhF,GAAvBgF;MACA,OAAO,KAAP;IACD;;IACD,MAAMqG,iBAAiB,GACpB/C,OAAO,CAASgD,EAAhBhD,IACAA,OAAO,CAASwC,kBADhBxC,IAED5J,eAAe,CAACsB,GAAD,CAAftB,KAAyBA,eAAe,CAACqF,EAAD,CAH1C;IAKA,MAAMwH,SAAS,GAAG,KACb,KAAKtD;IADQ,CAAlB,CAVkB,CAclB;IACA;;IACA,IAAKK,OAAO,CAASgD,EAArB,EAAyB;MACvB,KAAKhB,OAAL,GAAe,IAAf;IACD;;IAED,MAAMkB,UAAU,GAAGD,SAAS,CAACxM,MAA7B;;IAEA,IAAIrB,OAAO,CAACC,GAARD,CAAYE,mBAAhB,EAAqC;MACnC2N,SAAS,CAACxM,MAAVwM,GACEjD,OAAO,CAACvJ,MAARuJ,KAAmB,KAAnBA,GACI,KAAK9I,aADT8I,GAEIA,OAAO,CAACvJ,MAARuJ,IAAkBiD,SAAS,CAACxM,MAHlCwM;;MAKA,IAAI,OAAOjD,OAAO,CAACvJ,MAAf,KAA0B,WAA9B,EAA2C;QACzCuJ,OAAO,CAACvJ,MAARuJ,GAAiBiD,SAAS,CAACxM,MAA3BuJ;MACD;;MAED,MAAMmD,QAAQ,OAAGxC,iBAAH,EAAmBA,gBAAnB,CAAoB9L,WAAW,CAAC4G,EAAD,CAAX5G,GAAkBE,WAAW,CAAC0G,EAAD,CAA7B5G,GAAoC4G,EAAxD,CAAd;MACA,MAAM2H,gBAAgB,OAAGxM,oBAAH,EAAsBA,mBAAtB,CACpBuM,QAAQ,CAAChN,QADW,EAEpB,KAAKO,OAFe,CAAtB;;MAKA,IAAI0M,gBAAgB,CAACvM,cAArB,EAAqC;QACnCoM,SAAS,CAACxM,MAAVwM,GAAmBG,gBAAgB,CAACvM,cAApCoM;QACAE,QAAQ,CAAChN,QAATgN,GAAoBrO,WAAW,CAACqO,QAAQ,CAAChN,QAAV,CAA/BgN;QACA1H,EAAE,OAAGpB,UAAH,EAAuBA,oBAAvB,CAAwB8I,QAAxB,CAAF1H;QACA/D,GAAG,GAAG5C,WAAW,KACf8B,oBADe,EACIA,mBADJ,CAEb/B,WAAW,CAAC6C,GAAD,CAAX7C,GAAmBE,WAAW,CAAC2C,GAAD,CAA9B7C,GAAsC6C,GAFzB,EAGb,KAAKhB,OAHQ,EAIbP,QAJa,CAAjBuB;MAMD;;MACD,IAAI2L,WAAW,GAAG,KAAlB,CA3BmC,CA6BnC;MACA;;MACA,IAAIjO,OAAO,CAACC,GAARD,CAAYE,mBAAhB,EAAqC;YAE9BgO,IAF8B,CACnC;;QACA,IAAE,GAAGA,GAAY,GAAZ,KAAK5M,OAAR,MAAe,IAAf,IAAG4M,GAAY,WAAf,GAAG,MAAH,GAAGA,GAAY,CAAEvJ,QAAd,CAAuBkJ,SAAS,CAACxM,MAAjC,CAAH,CAAF,EAAgD;UAC9C0M,QAAQ,CAAChN,QAATgN,GAAoBxO,SAAS,CAACwO,QAAQ,CAAChN,QAAV,EAAoB8M,SAAS,CAACxM,MAA9B,CAA7B0M;UACAzG,MAAM,CAAC4B,QAAP5B,CAAgBzC,IAAhByC,GAAoB,IAAGrC,UAAH,EAAuBA,oBAAvB,CAAwB8I,QAAxB,CAApBzG,CAF8C,CAG9C;UACA;;UACA2G,WAAW,GAAG,IAAdA;QACD;MACF;;MAED,MAAMvM,cAAc,GAAG3B,kBAAkB,CACvC,KAAKwB,aADkC,EAEvCI,SAFuC,EAGvCkM,SAAS,CAACxM,MAH6B,CAAzC,CA1CmC,CAgDnC;MACA;;MACA,IAAIrB,OAAO,CAACC,GAARD,CAAYE,mBAAhB,EAAqC;QACnC;QACA;QACA,IAAE,CACC+N,WADD,IAEAvM,cAFA,IAGA,KAAKiL,cAHL,IAIA1B,IAAI,CAAC/B,QAAL+B,CAAckC,QAAdlC,KAA2BvJ,cAAc,CAACG,MAJ5C,EAKE;UACA,MAAMsM,YAAY,GAAGxO,WAAW,CAAC0G,EAAD,CAAhC;UACAiB,MAAM,CAAC4B,QAAP5B,CAAgBzC,IAAhByC,GAAwB,OAAM5F,cAAc,CAACE,IAAfF,GAAsB,EAAtBA,GAA2B,GAAI,MAC3DA,cAAc,CAACG,MAAM,GACpBnC,WAAW,IAEVmO,SAAS,CAACxM,MAAVwM,KAAqBnM,cAAc,CAACI,aAApC+L,GACI,EADJA,GAEK,IAAGA,SAAS,CAACxM,MAAM,KACvB8M,YAAY,KAAK,GAAjBA,GAAuB,EAAvBA,GAA4BA,YAAY,EAL/B,IAKqC,GALrC,CAKwC,EAPtD7G,CAFA,CAWA;UACA;;UACA2G,WAAW,GAAG,IAAdA;QACD;MACF;;MAED,IAAIA,WAAJ,EAAiB;QACf,OAAO,IAAIG,OAAJ,CAAW,MAAO,CAAE,CAApB,CAAP;MACD;IACF;;IAED,IAAE,CAAIxD,OAAO,CAASgD,EAAtB,EAA0B;MACxB,KAAKpC,KAAL,GAAa,KAAb;IACD,CAxGiB,CAyGlB;;;IACA,IAAI6C,MAAE,GAAN,EAAQ;MACNC,WAAW,CAACC,IAAZD,CAAiB,aAAjBA;IACD;;IAED,MAAM;MAAE3C,OAAO,GAAG,KAAZ;MAAmB6C,MAAM,GAAG;IAA5B,IAAqC5D,OAA3C;IACA,MAAM6D,UAAU,GAAG;MAAE9C;IAAF,CAAnB;;IAEA,IAAI,KAAK+C,cAAT,EAAyB;MACvB,KAAKC,kBAAL,CAAwB,KAAKD,cAA7B,EAA6CD,UAA7C;IACD;;IAEDpI,EAAE,GAAG3G,WAAW,CACdH,SAAS,CACPE,WAAW,CAAC4G,EAAD,CAAX5G,GAAkBE,WAAW,CAAC0G,EAAD,CAA7B5G,GAAoC4G,EAD7B,EAEPuE,OAAO,CAACvJ,MAFD,EAGP,KAAKS,aAHE,CADK,CAAhBuE;IAOA,MAAMuI,SAAS,GAAGpP,SAAS,CACzBC,WAAW,CAAC4G,EAAD,CAAX5G,GAAkBE,WAAW,CAAC0G,EAAD,CAA7B5G,GAAoC4G,EADX,EAEzBwH,SAAS,CAACxM,MAFe,CAA3B;IAIA,KAAKqN,cAAL,GAAsBrI,EAAtB;IAEA,IAAIwI,YAAY,GAAGf,UAAU,KAAKD,SAAS,CAACxM,MAA5C,CAlIkB,CAoIlB;IACA;IAEA;IACA;IACA;;IACA,IAAE,CACEuJ,OAAO,CAASgD,EADlB,IAEA,KAAKkB,eAAL,CAAqBF,SAArB,CAFA,IAE8B,CAC7BC,YAHH,EAIE;MACAhB,SAAS,CAAClI,MAAVkI,GAAmBe,SAAnBf;MACAtE,MAAM,CAAC6C,MAAP7C,CAAcwF,IAAdxF,CAAmB,iBAAnBA,EAAsClD,EAAtCkD,EAA0CkF,UAA1ClF,EAFA,CAGA;;MACA,KAAKiB,WAAL,CAAiBkD,MAAjB,EAAyBpL,GAAzB,EAA8B+D,EAA9B,EAAkC,KAC7BuE,OAD6B;QAEhC4D,MAAM,EAAE;MAFwB,CAAlC;;MAIA,IAAIA,MAAJ,EAAY;QACV,KAAKQ,YAAL,CAAkBJ,SAAlB;MACD;;MACD,KAAKK,GAAL,CAASpB,SAAT,EAAoB,KAAKhC,UAAL,CAAgBgC,SAAS,CAAChL,KAA1B,CAApB,EAAsD,IAAtD;MACA0G,MAAM,CAAC6C,MAAP7C,CAAcwF,IAAdxF,CAAmB,oBAAnBA,EAAyClD,EAAzCkD,EAA6CkF,UAA7ClF;MACA,OAAO,IAAP;IACD;;IAED,IAAI2F,MAAM,OAAG3D,iBAAH,EAAmBA,gBAAnB,CAAoBjJ,GAApB,CAAV;IACA,IAAI;MAAEvB,QAAF;MAAYgC;IAAZ,IAAsBmM,MAA1B,CA/JkB,CAiKlB;IACA;IACA;;IACA,IAAItI,KAAJ,EAAgBuI,QAAhB;;IACA,IAAI;OACAvI,OAAO;QAAEwI,UAAU,EAAED;MAAd,KAA4B,MAAMf,OAAO,CAACiB,GAARjB,CAAY,CACrD,KAAK3E,UAAL,CAAgB6F,WAAhB,EADqD,MAErDC,cAAsBA,wBAF+B,EAGrD,KAAK9F,UAAL,CAAgB+F,iBAAhB,EAHqD,CAAZpB;IAK5C,CAND,CAME,OAAOhF,GAAP,EAAY;MACZ;MACA;MACA9B,MAAM,CAAC4B,QAAP5B,CAAgBzC,IAAhByC,GAAuBjB,EAAvBiB;MACA,OAAO,KAAP;IACD,CAhLiB,CAkLlB;IACA;IACA;IACA;IACA;;;IACA,IAAE,CAAG,KAAKmI,QAAL,CAAcb,SAAd,CAAH,IAA0B,CAAMC,YAAlC,EAAgD;MAC9CnB,MAAM,GAAG,cAATA;IACD,CAzLiB,CA2LlB;IACA;;;IACA,IAAIpH,UAAU,GAAGD,EAAjB,CA7LkB,CA+LlB;IACA;IACA;;IACAtF,QAAQ,GAAGA,QAAQ,OACf+F,uBADe,EACQA,uBADR,CACSnH,WAAW,CAACoB,QAAD,CADpB,IAEfA,QAFJA;;IAIA,IAAI4M,iBAAiB,IAAI5M,QAAQ,KAAK,SAAtC,EAAiD;MAC7C6J,OAAO,CAASwC,kBAAhBxC,GAAqC,IAArCA;;MAEF,IAAI5K,OAAO,CAACC,GAARD,CAAYkN,mBAAZlN,IAAmCqG,EAAE,CAACvF,UAAHuF,CAAc,GAAdA,CAAvC,EAA2D;QACzD,MAAMqJ,cAAc,OAAGC,gBAAH,EAAkBC,OAAlB,CAClBlQ,WAAW,CAACH,SAAS,CAACqP,SAAD,EAAYf,SAAS,CAACxM,MAAtB,CAAV,CADO,EAElBuF,KAFkB,EAGlBuI,QAHkB,EAIlBpM,KAJkB,EAKjB8M,CADI,IACUlJ,mBAAmB,CAACkJ,CAAD,EAAIjJ,KAAJ,CALhB,EAMlB,KAAKtF,OANa,CAApB;;QASA,IAAIoO,cAAc,CAACI,YAAnB,EAAiC;UAC/B5G,QAAQ,CAACrE,IAATqE,GAAgB7C,EAAhB6C;UACA,OAAO,IAAP;QACD;;QACD5C,UAAU,GAAGoJ,cAAc,CAAC/J,MAA5BW;;QAEA,IAAIoJ,cAAc,CAACK,WAAfL,IAA8BA,cAAc,CAACxJ,YAAjD,EAA+D;UAC7D;UACA;UACAnF,QAAQ,GAAG2O,cAAc,CAACxJ,YAA1BnF;UACAmO,MAAM,CAACnO,QAAPmO,GAAkBxP,WAAW,CAACqB,QAAD,CAA7BmO;UACA5M,GAAG,OAAG2C,UAAH,EAAuBA,oBAAvB,CAAwBiK,MAAxB,CAAH5M;QACD;MACF,CAvBD,MAuBO;QACL4M,MAAM,CAACnO,QAAPmO,GAAkBvI,mBAAmB,CAAC5F,QAAD,EAAW6F,KAAX,CAArCsI;;QAEA,IAAIA,MAAM,CAACnO,QAAPmO,KAAoBnO,QAAxB,EAAkC;UAChCA,QAAQ,GAAGmO,MAAM,CAACnO,QAAlBA;UACAmO,MAAM,CAACnO,QAAPmO,GAAkBxP,WAAW,CAACqB,QAAD,CAA7BmO;UACA5M,GAAG,OAAG2C,UAAH,EAAuBA,oBAAvB,CAAwBiK,MAAxB,CAAH5M;QACD;MACF;IACF;;IAED,IAAE,CAAG1C,UAAU,CAACyG,EAAD,CAAf,EAAqB;MACnB,IAAIrG,OAAO,CAACC,GAARD,CAAYsJ,QAAZtJ,KAAyB,YAA7B,EAA2C;QACzC,MAAM,IAAIS,KAAJ,CACH,kBAAiB6B,GAAI,cAAa+D,EAAG,2CADzB,GAEV,oFAFC,CAAN;MAID;;MAEDiB,MAAM,CAAC4B,QAAP5B,CAAgBzC,IAAhByC,GAAuBjB,EAAvBiB;MACA,OAAO,KAAP;IACD;;IAEDhB,UAAU,GAAG9G,SAAS,CAACG,WAAW,CAAC2G,UAAD,CAAZ,EAA0BuH,SAAS,CAACxM,MAApC,CAAtBiF;IAEA;;;;;;IAKA,IAAE,EACEsE,OAAO,CAACe,OADV,IACsBf,OAAO,CAASgD,EAAhBhD,KAAuB,CAD7C,MAEEA,OAAO,CAASgD,EAAhBhD,KAAuB,CAAvBA,IAAwB,IACxB9E,UADwB,EACVA,cADU,CACV,IAACgB,uBAAD,EAAwBA,uBAAxB,CAAyB/F,QAAzB,CADU,CAF1B,CAAF,EAIE;MACA,MAAMiP,MAAM,GAAG,MAAM,KAAKC,iBAAL,CAAuB;QAC1C5J,EAD0C;QAE1C6J,KAAK,EAAElQ,OAAO,CAACC,GAARD,CAAYsJ,QAAZtJ,KAAyB,YAFU;QAG1C4G,KAH0C;QAI1C7F,QAJ0C;QAK1CgC,KAL0C;QAM1C1B,MAAM,EAAEwM,SAAS,CAACxM,MANwB;QAO1C0I,SAAS,EAAE8D,SAAS,CAAC9D;MAPqB,CAAvB,CAArB;;MAUA,IAAIiG,MAAM,CAACG,IAAPH,KAAgB,SAApB,EAA+B;QAC7BjN,KAAK,GAAG,KAAKA,KAAL;aAAeiN,MAAM,CAACjC,QAAPiC,CAAgBjN;QAA/B,CAARA;QACAuD,UAAU,GAAG0J,MAAM,CAACrK,MAApBW;QACAvF,QAAQ,GAAGiP,MAAM,CAAC9J,YAAlBnF;QACAmO,MAAM,CAACnO,QAAPmO,GAAkBc,MAAM,CAAC9J,YAAzBgJ;QACA5M,GAAG,OAAG2C,UAAH,EAAuBA,oBAAvB,CAAwBiK,MAAxB,CAAH5M;MACD,CAND,MAMO,IAAI0N,MAAM,CAACG,IAAPH,KAAgB,UAAhBA,IAA8BA,MAAM,CAACI,KAAzC,EAAgD;QACrD,OAAO,KAAK1E,MAAL,CAAYgC,MAAZ,EAAoBsC,MAAM,CAACK,MAA3B,EAAmCL,MAAM,CAACI,KAA1C,EAAiDxF,OAAjD,CAAP;MACD,CAFM,MAEA,IAAIoF,MAAM,CAACG,IAAPH,KAAgB,UAAhBA,IAA8BA,MAAM,CAACM,WAAzC,EAAsD;QAC3DhJ,MAAM,CAAC4B,QAAP5B,CAAgBzC,IAAhByC,GAAuB0I,MAAM,CAACM,WAA9BhJ;QACA,OAAO,IAAI8G,OAAJ,CAAW,MAAO,CAAE,CAApB,CAAP;MACD,CAHM,MAGA,IAAI4B,MAAM,CAACG,IAAPH,KAAgB,SAAhBA,IAA6B3J,EAAE,KAAKiB,MAAM,CAAC4B,QAAP5B,CAAgBvG,QAAxD,EAAkE;QACvEuG,MAAM,CAAC4B,QAAP5B,CAAgBzC,IAAhByC,GAAuBjB,EAAvBiB;QACA,OAAO,IAAI8G,OAAJ,CAAW,MAAO,CAAE,CAApB,CAAP;MACD;IACF;;IAED,MAAMvL,KAAK,OAAGiE,uBAAH,EAA0BA,uBAA1B,CAA2B/F,QAA3B,CAAX;;IAEA,IAAE,IAAE+E,UAAF,EAAgBA,cAAhB,CAAiBjD,KAAjB,CAAF,EAA2B;MACzB,MAAMkL,QAAQ,OAAGxC,iBAAH,EAAmBA,gBAAnB,CAAoBjF,UAApB,CAAd;MACA,MAAMxD,UAAU,GAAGiL,QAAQ,CAAChN,QAA5B;MAEA,MAAMwP,UAAU,OAAGrN,WAAH,EAAgBA,aAAhB,CAAiBL,KAAjB,CAAhB;MACA,MAAM2N,UAAU,OAAGlN,aAAH,EAAkBA,eAAlB,CAAmBiN,UAAnB,EAA+BzN,UAA/B,CAAhB;MACA,MAAM2N,iBAAiB,GAAG5N,KAAK,KAAKC,UAApC;MACA,MAAM+C,cAAc,GAAG4K,iBAAiB,GACpC5Q,aAAa,CAACgD,KAAD,EAAQC,UAAR,EAAoBC,KAApB,CADuB,GAEnC,EAFL;;MAIA,IAAE,CAAGyN,UAAH,IAAkBC,iBAAiB,KAAK5K,cAAc,CAACvB,MAAzD,EAAkE;QAChE,MAAMoM,aAAa,GAAGnQ,MAAM,CAACiD,IAAPjD,CAAYgQ,UAAU,CAACnN,MAAvB7C,EAA+BoQ,MAA/BpQ,CACnBmD,KADwD,IACnD,CAAMX,KAAK,CAACW,KAAD,CADGnD,CAAtB;;QAIA,IAAImQ,aAAa,CAACvP,MAAduP,GAAuB,CAA3B,EAA8B;UAC5B,IAAI1Q,OAAO,CAACC,GAARD,CAAYsJ,QAAZtJ,KAAyB,YAA7B,EAA2C;YACzCuF,OAAO,CAACqL,IAARrL,CAAY,GAERkL,iBAAiB,GACZ,oBADY,GAEZ,iCACN,8BALS,GAMP,eAAcC,aAAa,CAACrM,IAAdqM,CACb,IADaA,CAEb,8BARNnL;UAUD;;UAED,MAAM,IAAI9E,KAAJ,CAAS,CACZgQ,iBAAiB,GACb,0BAAyBnO,GAAI,oCAAmCoO,aAAa,CAACrM,IAAdqM,CAC/D,IAD+DA,CAE/D,iCAHY,GAIb,8BAA6B5N,UAAW,8CAA6CD,KAAM,KALnF,IAMV,+CACC4N,iBAAiB,GACb,2BADa,GAEb,sBAAsB,EAT1B,CAAN;QAYD;MACF,CAhCD,MAgCO,IAAIA,iBAAJ,EAAuB;QAC5BpK,EAAE,OAAGpB,UAAH,EAAuBA,oBAAvB,CACA1E,MAAM,CAACC,MAAPD,CAAc,EAAdA,EAAkBwN,QAAlBxN,EAA4B;UAC1BQ,QAAQ,EAAE8E,cAAc,CAACvB,MADC;UAE1BvB,KAAK,EAAEwB,kBAAkB,CAACxB,KAAD,EAAQ8C,cAAc,CAACtC,MAAvB;QAFC,CAA5BhD,CADA,CAAF8F;MAMD,CAPM,MAOA;QACL;QACA9F,MAAM,CAACC,MAAPD,CAAcwC,KAAdxC,EAAqBiQ,UAArBjQ;MACD;IACF;;IAEDgJ,MAAM,CAAC6C,MAAP7C,CAAcwF,IAAdxF,CAAmB,kBAAnBA,EAAuClD,EAAvCkD,EAA2CkF,UAA3ClF;;IAEA,IAAI;UAoFA0B,MAAwB4F;MAnF1B,IAAIC,SAAS,GAAG,MAAM,KAAKC,YAAL,CACpBlO,KADoB,EAEpB9B,QAFoB,EAGpBgC,KAHoB,EAIpBsD,EAJoB,EAKpBC,UALoB,EAMpBmI,UANoB,EAOpBZ,SAAS,CAACxM,MAPU,EAQpBwM,SAAS,CAAC9D,SARU,CAAtB;MAUA,IAAI;QAAEvE,KAAF;QAASuG,KAAT;QAAgBC,OAAhB;QAAyBC;MAAzB,IAAqC6E,SAAzC;MAEA,MAAME,SAAS,GAAQF,SAAS,CAAClH,SAAjC;;MACA,IAAIoH,SAAS,IAAIA,SAAS,CAACC,qBAA3B,EAAkD;QAChD,MAAMC,OAAO,GAAG,GAAGC,MAAH,CAAUH,SAAS,CAACC,qBAAVD,EAAV,CAAhB;QAEAE,OAAO,CAACzM,OAARyM,CAAiBE,MAAF,IAAkB;cAC/BC,SAAsBA,uBAACD,MAAM,CAACrF;QAC/B,CAFDmF;MAGD,CApBC,CAsBF;;;MACA,IAAE,CAAGlF,OAAO,IAAIC,OAAd,KAA0BF,KAA5B,EAAmC;QACjC,IAAIA,KAAK,CAACuF,SAANvF,IAAmBA,KAAK,CAACuF,SAANvF,CAAgBwF,YAAvC,EAAqD;UACnD,MAAMjB,WAAW,GAAGvE,KAAK,CAACuF,SAANvF,CAAgBwF,YAApC,CADmD,CAGnD;UACA;UACA;;UACA,IACEjB,WAAW,CAACxP,UAAZwP,CAAuB,GAAvBA,KACAvE,KAAK,CAACuF,SAANvF,CAAgByF,sBAAhBzF,KAA2C,KAF7C,EAGE;YACA,MAAM0F,UAAU,OAAGlG,iBAAH,EAAmBA,gBAAnB,CAAoB+E,WAApB,CAAhB;YACAmB,UAAU,CAAC1Q,QAAX0Q,GAAsB9K,mBAAmB,CACvC8K,UAAU,CAAC1Q,QAD4B,EAEvC6F,KAFuC,CAAzC6K;YAKA,MAAM;cAAEnP,GAAG,EAAE+N,MAAP;cAAehK,EAAE,EAAE+J;YAAnB,IAA6BhK,YAAY,CAC7C,IAD6C,EAE7CkK,WAF6C,EAG7CA,WAH6C,CAA/C;YAKA,OAAO,KAAK5E,MAAL,CAAYgC,MAAZ,EAAoB2C,MAApB,EAA4BD,KAA5B,EAAmCxF,OAAnC,CAAP;UACD;;UAEDtD,MAAM,CAAC4B,QAAP5B,CAAgBzC,IAAhByC,GAAuBgJ,WAAvBhJ;UACA,OAAO,IAAI8G,OAAJ,CAAW,MAAO,CAAE,CAApB,CAAP;QACD;;QAEDP,SAAS,CAAC9D,SAAV8D,GAAmB,EAAK9B,KAAK,CAAC2F,WAA9B7D,CA7BiC,CA+BjC;;QACA,IAAI9B,KAAK,CAACrD,QAANqD,KAAmBlE,kBAAvB,EAA2C;UACzC,IAAI8J,aAAJ;;UAEA,IAAI;YACF,MAAM,KAAKC,cAAL,CAAoB,MAApB,CAAN;YACAD,aAAa,GAAG,MAAhBA;UACD,CAHD,CAGE,OAAO/O,CAAP,EAAU;YACV+O,aAAa,GAAG,SAAhBA;UACD;;UAEDb,SAAS,GAAG,MAAM,KAAKC,YAAL,CAChBY,aADgB,EAEhBA,aAFgB,EAGhB5O,KAHgB,EAIhBsD,EAJgB,EAKhBC,UALgB,EAMhB;YAAEqF,OAAO,EAAE;UAAX,CANgB,EAOhBkC,SAAS,CAACxM,MAPM,EAQhBwM,SAAS,CAAC9D,SARM,CAAlB+G;QAUD;MACF;;MAEDvH,MAAM,CAAC6C,MAAP7C,CAAcwF,IAAdxF,CAAmB,qBAAnBA,EAA0ClD,EAA1CkD,EAA8CkF,UAA9ClF;MACA,KAAKiB,WAAL,CAAiBkD,MAAjB,EAAyBpL,GAAzB,EAA8B+D,EAA9B,EAAkCuE,OAAlC;;MAEA,IACGA,OAAO,CAASgD,EAAhBhD,IACD7J,QAAQ,KAAK,SADZ6J,IACqB,EACtBK,IAAwB,GAAxBA,IAAI,CAACqB,aAALrB,CAAmBc,KADG,MACE,IADF,IACtBd,IAAwB,WADF,GACtBA,MADsB,GACa,QAAnCA,IAAwB,CAAEqG,SAAS,gCAAnCrG,MAAmC,QAAE4G,UADf,MAC8B,GAFnDjH,KAGDmB,KAAK,SAALA,SAAK,WAALA,iBAAK,CAAEuF,SAHN1G,CADH,EAKE;QACA;QACA;QACAmB,KAAK,CAACuF,SAANvF,CAAgB8F,UAAhB9F,GAA6B,GAA7BA;MACD,CA1FC,CA4FF;;;MACA,MAAM+F,mBAAmB,GAAGlH,OAAO,CAACe,OAARf,IAAmBiD,SAAS,CAAChL,KAAVgL,KAAoBhL,KAAnE;;UAEqB+H;;MAArB,MAAMmH,YAAY,IAAGnH,OAAc,GAAdA,OAAO,CAAC4D,MAAX,MAAiB,IAAjB,IAAG5D,OAAc,WAAjB,GAAGA,OAAH,GAAiB,CAAKkH,mBAAxC;MACA,MAAME,WAAW,GAAGD,YAAY,GAAG;QAAE/G,CAAC,EAAE,CAAL;QAAQG,CAAC,EAAE;MAAX,CAAH,GAAoB,IAApD;MAEA,MAAM,KAAK8D,GAAL,CACJ,KACKpB,SADL;QAEEhL,KAFF;QAGE9B,QAHF;QAIEgC,KAJF;QAKE4C,MAAM,EAAEiJ,SALV;QAME9E,UAAU,EAAE;MANd,CADI,EASJgH,SATI,EAUJnG,YAAY,SAAZA,gBAAY,WAAZA,kBAAgBqH,WAVZ,EAWJ7I,KAXI,CAWGmB,CAAF,IAAQ;QACb,IAAIA,CAAC,CAAC5J,SAAN,EAAiB8E,KAAK,GAAGA,KAAK,IAAI8E,CAAjB9E,CAAjB,KACK,MAAM8E,CAAN;MACN,CAdK,CAAN;;MAgBA,IAAI9E,KAAJ,EAAW;QACT+D,MAAM,CAAC6C,MAAP7C,CAAcwF,IAAdxF,CAAmB,kBAAnBA,EAAuC/D,KAAvC+D,EAA8CqF,SAA9CrF,EAAyDkF,UAAzDlF;QACA,MAAM/D,KAAN;MACD;;MAED,IAAIxF,OAAO,CAACC,GAARD,CAAYE,mBAAhB,EAAqC;QACnC,IAAI2N,SAAS,CAACxM,MAAd,EAAsB;UACpB4Q,QAAQ,CAACC,eAATD,CAAyBE,IAAzBF,GAAgCpE,SAAS,CAACxM,MAA1C4Q;QACD;MACF;;MACD1I,MAAM,CAAC6C,MAAP7C,CAAcwF,IAAdxF,CAAmB,qBAAnBA,EAA0ClD,EAA1CkD,EAA8CkF,UAA9ClF;MAEA,OAAO,IAAP;IACD,CA/HD,CA+HE,OAAOH,IAAP,EAAY;MACZ,IAAE,IAAEgJ,QAAF,EAASxC,OAAT,CAAUxG,IAAV,KAAkBA,IAAG,CAAC1I,SAAxB,EAAmC;QACjC,OAAO,KAAP;MACD;;MACD,MAAM0I,IAAN;IACD;EACF;;EAEDoB,WAAW,CACTkD,MADS,EAETpL,GAFS,EAGT+D,EAHS,EAKH;IAAA,IADNuE,OACM,uEADuB,EACvB;;IACN,IAAI5K,OAAO,CAACC,GAARD,CAAYsJ,QAAZtJ,KAAyB,YAA7B,EAA2C;MACzC,IAAI,OAAOsH,MAAM,CAACC,OAAd,KAA0B,WAA9B,EAA2C;QACzChC,OAAO,CAACC,KAARD,CAAe,2CAAfA;QACA;MACD;;MAED,IAAI,OAAO+B,MAAM,CAACC,OAAPD,CAAeoG,MAAfpG,CAAP,KAAkC,WAAtC,EAAmD;QACjD/B,OAAO,CAACC,KAARD,CAAe,2BAA0BmI,MAAO,mBAAhDnI;QACA;MACD;IACF;;IAED,IAAImI,MAAM,KAAK,WAAXA,IAAsB,IAAIjD,MAAJ,EAAUA,MAAV,OAAiBpE,EAA3C,EAA+C;MAC7C,KAAKuF,QAAL,GAAgBhB,OAAO,CAACe,OAAxB;MACArE,MAAM,CAACC,OAAPD,CAAeoG,MAAfpG,EACE;QACEhF,GADF;QAEE+D,EAFF;QAGEuE,OAHF;QAIEF,GAAG,EAAE,IAJP;QAKEG,GAAG,EAAG,KAAKT,IAAL,GAAYsD,MAAM,KAAK,WAAXA,GAAyB,KAAKtD,IAA9BsD,GAAqC,KAAKtD,IAAL,GAAY;MALrE,CADF9C,EAQE;MACA;MACA;MACA,EAXFA,EAYEjB,EAZFiB;IAcD;EACF;;EAEyB,MAApB+K,oBAAoB,CACxBjJ,GADwB,EAExBrI,QAFwB,EAGxBgC,KAHwB,EAIxBsD,EAJwB,EAKxBoI,UALwB,EAMxB6D,aANwB,EAOW;IACnC,IAAIlJ,GAAG,CAAC1I,SAAR,EAAmB;MACjB;MACA,MAAM0I,GAAN;IACD;;IAED,IAAE,IAAEmJ,YAAF,EAAcA,YAAd,CAAenJ,GAAf,KAAuBkJ,aAAzB,EAAwC;MACtC/I,MAAM,CAAC6C,MAAP7C,CAAcwF,IAAdxF,CAAmB,kBAAnBA,EAAuCH,GAAvCG,EAA4ClD,EAA5CkD,EAAgDkF,UAAhDlF,EADsC,CAGtC;MACA;MACA;MACA;MAEA;;MACAjC,MAAM,CAAC4B,QAAP5B,CAAgBzC,IAAhByC,GAAuBjB,EAAvBiB,CATsC,CAWtC;MACA;;MACA,MAAMhH,sBAAsB,EAA5B;IACD;;IAED,IAAI;MACF,IAAIsJ,SAAJ;MACA,IAAIuC,WAAJ;MACA,IAAIJ,KAAJ;;MAEA,IACE,OAAOnC,SAAP,KAAsB,WAAtB,IACA,OAAOuC,WAAP,KAAwB,WAF1B,EAGE;SACE;UAAElF,IAAI,EAAE2C,SAAR;UAAmBuC;QAAnB,IAAmC,MAAM,KAAKyF,cAAL,CACzC,SADyC;MAG5C;;MAED,MAAMd,SAAS,GAA6B;QAC1C/E,KAD0C;QAE1CnC,SAF0C;QAG1CuC,WAH0C;QAI1C/C,GAJ0C;QAK1C5D,KAAK,EAAE4D;MALmC,CAA5C;;MAQA,IAAE,CAAG0H,SAAS,CAAC/E,KAAf,EAAsB;QACpB,IAAI;UACF+E,SAAS,CAAC/E,KAAV+E,GAAkB,MAAM,KAAK0B,eAAL,CAAqB5I,SAArB,EAAgC;YACtDR,GADsD;YAEtDrI,QAFsD;YAGtDgC;UAHsD,CAAhC,CAAxB+N;QAKD,CAND,CAME,OAAO2B,MAAP,EAAe;UACflN,OAAO,CAACC,KAARD,CAAc,yCAAdA,EAAyDkN,MAAzDlN;UACAuL,SAAS,CAAC/E,KAAV+E,GAAkB,EAAlBA;QACD;MACF;;MAED,OAAOA,SAAP;IACD,CApCD,CAoCE,OAAO4B,YAAP,EAAqB;MACrB,OAAO,KAAKL,oBAAL,CAAyB,IAC9BD,QAD8B,EACvBxC,OADuB,CACtB8C,YADsB,IACNA,YADM,GACS,IAAIjS,KAAJ,CAAUiS,YAAY,GAAG,EAAzB,CADlC,EAEL3R,QAFK,EAGLgC,KAHK,EAILsD,EAJK,EAKLoI,UALK,EAML,IANK,CAAP;IAQD;EACF;;EAEiB,MAAZsC,YAAY,CAChBlO,KADgB,EAEhB9B,QAFgB,EAGhBgC,KAHgB,EAIhBsD,EAJgB,EAKhBC,UALgB,EAMhBmI,UANgB,EAOhBpN,MAPgB,EAQhB0I,SARgB,EASW;IAC3B,IAAI;MACF,MAAM4I,iBAAiB,GACrB,KAAK9G,UAAL,CAAgBhJ,KAAhB,CADF;;MAEA,IAAI4L,UAAU,CAAC9C,OAAX8C,IAAsBkE,iBAAtBlE,IAA2C,KAAK5L,KAAL,KAAeA,KAA9D,EAAqE;QACnE,OAAO8P,iBAAP;MACD;;MAED,IAAIC,eAAe,GAAyCjR,SAA5D,CAPE,CAQF;MACA;;MACA,IACE3B,OAAO,CAACC,GAARD,CAAYsJ,QAAZtJ,KAAyB,aAAzBA,IACA2S,iBADA3S,IACiB,EACf,aAAa2S,iBADE,CAFnB,EAIE;QACAC,eAAe,GAAGD,iBAAlBC;MACD;;MACD,MAAM9B,SAAS,GACb8B,eAAe,KACd,MAAM,KAAKhB,cAAL,CAAoB/O,KAApB,EAA2BuF,IAA3B,CAAiCC,GAAF,KAAW;QAC/CuB,SAAS,EAAEvB,GAAG,CAACpB,IADgC;QAE/CkF,WAAW,EAAE9D,GAAG,CAAC8D,WAF8B;QAG/CH,OAAO,EAAE3D,GAAG,CAACwK,GAAJxK,CAAQ2D,OAH8B;QAI/CC,OAAO,EAAE5D,GAAG,CAACwK,GAAJxK,CAAQ4D,OAJ8B;QAK/CC,OAAO,IAAI7D,GAAG,CAACwK,GAAJxK,CAAQyK;MAL4B,CAAX,CAA/B,CADQ,CADjB;MAUA,MAAM;QAAElJ,SAAF;QAAaoC,OAAb;QAAsBC,OAAtB;QAA+BC;MAA/B,IAA2C4E,SAAjD;;MAEA,IAAI9Q,OAAO,CAACC,GAARD,CAAYsJ,QAAZtJ,KAAyB,YAA7B,EAA2C;QACzC,MAAM;UAAE+S;QAAF,IAAyB5S,OAAO,CAAC,6BAAD,CAAtC;;QACA,IAAE,CAAG4S,kBAAkB,CAACnJ,SAAD,CAAvB,EAAoC;UAClC,MAAM,IAAInJ,KAAJ,CACH,yDAAwDM,QAAS,GAD9D,CAAN;QAGD;MACF;;MAED,IAAI8H,QAAJ,CAtCE,CAwCF;MACA;MACA;MACA;;MACA,MAAMmK,qBAAqB,IACxBhT,OAAO,CAACC,GAARD,CAAYsJ,QAAZtJ,KAAyB,YAAzBA,IAAyCiM,OADjB,KAC6BC,OADxD;;MAGA,IAAIF,OAAO,IAAIC,OAAXD,IAAsBE,OAA1B,EAAmC;QACjCrD,QAAQ,GAAG,KAAKY,UAAL,CAAgBwJ,WAAhB,CAA4B;UACrCpO,IAAI,MAAEI,UAAF,EAAsBA,oBAAtB,CAAuB;YAAElE,QAAF;YAAYgC;UAAZ,CAAvB,CADiC;UAErC4C,MAAM,EAAEW,UAF6B;UAGrC4M,GAAG,EAAElH,OAHgC;UAIrCmH,MAAM,EAAEH,qBAJ6B;UAKrC3R;QALqC,CAA5B,CAAXwH;MAOD;;MAED,MAAMkD,KAAK,GAAG,MAAM,KAAKqH,QAAL,CAAa,OAC9BpH,OAAO,IAAIC,OAAXD,IAAsBE,OADQ,KACD,CAAM8G,qBADL,GAE3BpK,aAAa,CACXC,QADW,EAEX,KAAK2C,KAFM,EAGX,KAHW,EAIXQ,OAAO,GAAG,KAAK/B,GAAR,GAAc,KAAKC,GAJf,EAIkB,EAC3B8B,OAD2B,IACpB,CAAKjC,SALH,CAFc,GAS3B,KAAKyI,eAAL,CACE5I,SADF,EAEE;MACA;QACE7I,QADF;QAEEgC,KAFF;QAGE4C,MAAM,EAAEU,EAHV;QAIEhF,MAJF;QAKEC,OAAO,EAAE,KAAKA,OALhB;QAMEQ,aAAa,EAAE,KAAKA;MANtB,CAHF,CATc,CAApB;;MAuBA,IAAIoK,OAAJ,EAAa;QACX,IAAI8G,qBAAJ,EAA2B;UACzB,MAAM;YAAEvK;UAAF,IAAY,MAAM,KAAK2K,QAAL,CAAa,MACnC,KAAKC,cAAL,CAAoBxK,QAApB,CADsB,CAAxB;UAGEkD,KAAK,CAASuF,SAAdvF,GAA0BxL,MAAM,CAACC,MAAPD,CAAewL,KAAK,CAASuF,SAA7B/Q,EAAwC;YAClE+S,UAAU,EAAE7K;UADsD,CAAxClI,CAA1BwL;QAGH,CAPD,MAOO;UACL,MAAM;YAAEuH;UAAF,IAAiBvH,KAAvB;UACEA,KAAK,CAASuF,SAAdvF,GAA0BxL,MAAM,CAACC,MAAPD,CAC1B,EAD0BA,EAEzBwL,KAAK,CAASuF,SAFW/Q,EAG1B;YACE+S;UADF,CAH0B/S,CAA1BwL;QAOH;MACF;;MAED+E,SAAS,CAAC/E,KAAV+E,GAAkB/E,KAAlB+E;MACA,KAAKjF,UAAL,CAAgBhJ,KAAhB,IAAyBiO,SAAzB;MACA,OAAOA,SAAP;IACD,CAvGD,CAuGE,OAAO1H,GAAP,EAAY;MACZ,OAAO,KAAKiJ,oBAAL,CAAyB,IAC9BkB,QAD8B,EAChBA,cADgB,CACfnK,GADe,CAAzB,EAELrI,QAFK,EAGLgC,KAHK,EAILsD,EAJK,EAKLoI,UALK,CAAP;IAOD;EACF;;EAEOQ,GAAG,CACT1E,KADS,EAET9B,IAFS,EAGTuJ,WAHS,EAIM;IACf,KAAKzH,KAAL,GAAaA,KAAb;IAEA,OAAO,KAAKiC,GAAL,CACL/D,IADK,EAEL,KAAKoD,UAAL,CAAgB,OAAhB,EAAyBjC,SAFpB,EAGLoI,WAHK,CAAP;EAKD;EAED;;;;;;EAIAwB,cAAc,CAACC,EAAD,EAA6B;IACzC,KAAKhI,IAAL,GAAYgI,EAAZ;EACD;;EAED3E,eAAe,CAACzI,EAAD,EAAsB;IACnC,IAAE,CAAG,KAAKV,MAAV,EAAkB,OAAO,KAAP;IAClB,MAAK,CAAE+N,YAAF,EAAgBC,OAAhB,IAA2B,KAAKhO,MAAL,CAAYL,KAAZ,CAAkB,GAAlB,CAAhC;IACA,MAAK,CAAEsO,YAAF,EAAgBC,OAAhB,IAA2BxN,EAAE,CAACf,KAAHe,CAAS,GAATA,CAAhC,CAHmC,CAKnC;;IACA,IAAIwN,OAAO,IAAIH,YAAY,KAAKE,YAA5BC,IAA4CF,OAAO,KAAKE,OAA5D,EAAqE;MACnE,OAAO,IAAP;IACD,CARkC,CAUnC;;;IACA,IAAIH,YAAY,KAAKE,YAArB,EAAmC;MACjC,OAAO,KAAP;IACD,CAbkC,CAenC;IACA;IACA;IACA;;;IACA,OAAOD,OAAO,KAAKE,OAAnB;EACD;;EAED7E,YAAY,CAAC3I,EAAD,EAAmB;IAC7B,MAAK,GAAIJ,IAAI,GAAG,EAAX,IAAiBI,EAAE,CAACf,KAAHe,CAAS,GAATA,CAAtB,CAD6B,CAE7B;IACA;;IACA,IAAIJ,IAAI,KAAK,EAATA,IAAeA,IAAI,KAAK,KAA5B,EAAmC;MACjCqB,MAAM,CAACwM,QAAPxM,CAAgB,CAAhBA,EAAmB,CAAnBA;MACA;IACD,CAP4B,CAS7B;;;IACA,MAAMyM,IAAI,GAAG9B,QAAQ,CAAC+B,cAAT/B,CAAwBhM,IAAxBgM,CAAb;;IACA,IAAI8B,IAAJ,EAAU;MACRA,IAAI,CAACE,cAALF;MACA;IACD,CAd4B,CAe7B;IACA;;;IACA,MAAMG,MAAM,GAAGjC,QAAQ,CAACkC,iBAATlC,CAA2BhM,IAA3BgM,EAAiC,CAAjCA,CAAf;;IACA,IAAIiC,MAAJ,EAAY;MACVA,MAAM,CAACD,cAAPC;IACD;EACF;;EAEDzE,QAAQ,CAAC9J,MAAD,EAA0B;IAChC,OAAO,KAAKA,MAAL,KAAgBA,MAAvB;EACD;EAED;;;;;;;;EAMc,MAARyO,QAAQ,CACZ9R,GADY,EAIG;IAAA,IAFfqD,MAEe,uEAFErD,GAEF;IAAA,IADfsI,OACe,uEADY,EACZ;IACf,IAAIsE,MAAM,OAAG3D,iBAAH,EAAmBA,gBAAnB,CAAoBjJ,GAApB,CAAV;IAEA,IAAI;MAAEvB,QAAF;MAAYgC;IAAZ,IAAsBmM,MAA1B;;IAEA,IAAIlP,OAAO,CAACC,GAARD,CAAYE,mBAAhB,EAAqC;MACnC,IAAI0K,OAAO,CAACvJ,MAARuJ,KAAmB,KAAvB,EAA8B;QAC5B7J,QAAQ,OAAGS,oBAAH,EAAsBA,mBAAtB,CAAwBT,QAAxB,EAAkC,KAAKO,OAAvC,EAAgDP,QAAxDA;QACAmO,MAAM,CAACnO,QAAPmO,GAAkBnO,QAAlBmO;QACA5M,GAAG,OAAG2C,UAAH,EAAuBA,oBAAvB,CAAwBiK,MAAxB,CAAH5M;QAEA,IAAIyL,QAAQ,OAAGxC,iBAAH,EAAmBA,gBAAnB,CAAoB5F,MAApB,CAAZ;QACA,MAAMqI,gBAAgB,OAAGxM,oBAAH,EAAsBA,mBAAtB,CACpBuM,QAAQ,CAAChN,QADW,EAEpB,KAAKO,OAFe,CAAtB;QAIAyM,QAAQ,CAAChN,QAATgN,GAAoBC,gBAAgB,CAACjN,QAArCgN;QACAnD,OAAO,CAACvJ,MAARuJ,GAAiBoD,gBAAgB,CAACvM,cAAjBuM,IAAmC,KAAKlM,aAAzD8I;QACAjF,MAAM,OAAGV,UAAH,EAAuBA,oBAAvB,CAAwB8I,QAAxB,CAANpI;MACD;IACF;;IAED,MAAMiB,KAAK,GAAG,MAAM,KAAK6C,UAAL,CAAgB6F,WAAhB,EAApB;IACA,IAAIhJ,UAAU,GAAGX,MAAjB;;IAEA,IAAI3F,OAAO,CAACC,GAARD,CAAYkN,mBAAZlN,IAAmC2F,MAAM,CAAC7E,UAAP6E,CAAkB,GAAlBA,CAAvC,EAA+D;MAC7D,IAAIwJ,QAAJ;OACE;QAAEC,UAAU,EAAED;MAAd,IAA2B,MAAK,IAACI,YAAD,EAAuBA,sBAAvB;MAElC,MAAMG,cAAc,OAAGC,gBAAH,EAAkBC,OAAlB,CAClBlQ,WAAW,CAACH,SAAS,CAACoG,MAAD,EAAS,KAAKtE,MAAd,CAAV,CADO,EAElBuF,KAFkB,EAGlBuI,QAHkB,EAIlBD,MAAM,CAACnM,KAJW,EAKjB8M,CADW,IACGlJ,mBAAmB,CAACkJ,CAAD,EAAIjJ,KAAJ,CALhB,EAMlB,KAAKtF,OANa,CAApB;;MASA,IAAIoO,cAAc,CAACI,YAAnB,EAAiC;QAC/B;MACD;;MACDxJ,UAAU,GAAG9G,SAAS,CAACG,WAAW,CAAC+P,cAAc,CAAC/J,MAAhB,CAAZ,EAAqC,KAAKtE,MAA1C,CAAtBiF;;MAEA,IAAIoJ,cAAc,CAACK,WAAfL,IAA8BA,cAAc,CAACxJ,YAAjD,EAA+D;QAC7D;QACA;QACAnF,QAAQ,GAAG2O,cAAc,CAACxJ,YAA1BnF;QACAmO,MAAM,CAACnO,QAAPmO,GAAkBnO,QAAlBmO;QACA5M,GAAG,OAAG2C,UAAH,EAAuBA,oBAAvB,CAAwBiK,MAAxB,CAAH5M;MACD;IACF,CAzBD,MAyBO;MACL4M,MAAM,CAACnO,QAAPmO,GAAkBvI,mBAAmB,CAACuI,MAAM,CAACnO,QAAR,EAAkB6F,KAAlB,CAArCsI;;MAEA,IAAIA,MAAM,CAACnO,QAAPmO,KAAoBnO,QAAxB,EAAkC;QAChCA,QAAQ,GAAGmO,MAAM,CAACnO,QAAlBA;QACAmO,MAAM,CAACnO,QAAPmO,GAAkBnO,QAAlBmO;QACA5M,GAAG,OAAG2C,UAAH,EAAuBA,oBAAvB,CAAwBiK,MAAxB,CAAH5M;MACD;IACF,CA1Dc,CA4Df;;;IACA,IAAItC,OAAO,CAACC,GAARD,CAAYsJ,QAAZtJ,KAAyB,YAA7B,EAA2C;MACzC;IACD;;IAED,MAAMqU,OAAO,GAAG,MAAM,KAAKpE,iBAAL,CAAuB;MAC3C5J,EAAE,EAAE3G,WAAW,CAACiG,MAAD,CAD4B;MAE3CuK,KAAK,EAAE,IAFoC;MAG3CtJ,KAH2C;MAI3C7F,QAJ2C;MAK3CgC,KAL2C;MAM3C1B,MAAM,EAAE,KAAKA,MAN8B;MAO3C0I,SAAS,EAAE,KAAKA;IAP2B,CAAvB,CAAtB;;IAUA,IAAIsK,OAAO,CAAClE,IAARkE,KAAiB,SAArB,EAAgC;MAC9BnF,MAAM,CAACnO,QAAPmO,GAAkBmF,OAAO,CAACnO,YAA1BgJ;MACAnO,QAAQ,GAAGsT,OAAO,CAACnO,YAAnBnF;MACAgC,KAAK,GAAG,KAAKA,KAAL;WAAesR,OAAO,CAACtG,QAARsG,CAAiBtR;MAAhC,CAARA;MACAuD,UAAU,GAAG+N,OAAO,CAAC1O,MAArBW;MACAhE,GAAG,OAAG2C,UAAH,EAAuBA,oBAAvB,CAAwBiK,MAAxB,CAAH5M;IACD;;IAED,MAAMO,KAAK,OAAGiE,uBAAH,EAA0BA,uBAA1B,CAA2B/F,QAA3B,CAAX;IAEA,MAAMqN,OAAO,CAACiB,GAARjB,CAAY,CAChB,KAAK3E,UAAL,CAAgB6K,MAAhB,CAAuBzR,KAAvB,EAA8BuF,IAA9B,CAAoCmM,KAAF,IAAqB;MACrD,OAAOA,KAAK,GACR3L,aAAa,CACX,KAAKa,UAAL,CAAgBwJ,WAAhB,CAA4B;QAC1BpO,IAAI,EAAEvC,GADoB;QAE1BqD,MAAM,EAAEW,UAFkB;QAG1B4M,GAAG,EAAE,IAHqB;QAI1B7R,MAAM,EACJ,OAAOuJ,OAAO,CAACvJ,MAAf,KAA0B,WAA1B,GACIuJ,OAAO,CAACvJ,MADZ,GAEI,KAAKA;MAPe,CAA5B,CADW,EAUX,KAVW,EAWX,KAXW,EAYX,KAAK4I,GAZM,EAaX,IAbW,CADL,GAgBR,KAhBJ;IAiBD,CAlBD,CADgB,EAoBhB,KAAKR,UAAL,CAAgBmB,OAAO,CAAC4J,QAAR5J,GAAmB,UAAnBA,GAAgC,UAAhD,EAA4D/H,KAA5D,CApBgB,CAAZuL,CAAN;EAsBD;;EAEmB,MAAdwD,cAAc,CAAC/O,KAAD,EAAgB;IAClC,IAAInC,SAAS,GAAG,KAAhB;;IACA,MAAM+T,MAAM,GAAI,KAAKhI,GAAL,GAAQ,MAAS;MAC/B/L,SAAS,GAAG,IAAZA;IACD,CAFD;;IAIA,MAAMgU,eAAe,SAAS;MAC5B,IAAIhU,SAAJ,EAAe;QACb,MAAM8E,KAAK,GAAQ,IAAI/E,KAAJ,CAChB,wCAAuCoC,KAAM,GAD7B,CAAnB;QAGA2C,KAAK,CAAC9E,SAAN8E,GAAkB,IAAlBA;QACA,MAAMA,KAAN;MACD;;MAED,IAAIiP,MAAM,KAAK,KAAKhI,GAApB,EAAyB;QACvB,KAAKA,GAAL,GAAW,IAAX;MACD;IACF,CAZD;;IAcA,IAAI;MACF,MAAMkI,eAAe,GAAG,MAAM,KAAKlL,UAAL,CAAgBmL,QAAhB,CAAyB/R,KAAzB,CAA9B;MAEA6R,eAAe;MAEf,OAAOC,eAAP;IACD,CAND,CAME,OAAOvL,GAAP,EAAY;MACZsL,eAAe;MAEf,MAAMtL,GAAN;IACD;EACF;;EAEDgK,QAAQ,CAAIyB,EAAJ,EAAsC;IAC5C,IAAInU,SAAS,GAAG,KAAhB;;IACA,MAAM+T,MAAM,SAAS;MACnB/T,SAAS,GAAG,IAAZA;IACD,CAFD;;IAGA,KAAK+L,GAAL,GAAWgI,MAAX;IACA,OAAOI,EAAE,GAAGzM,IAALyM,CAAWpM,IAAF,IAAW;MACzB,IAAIgM,MAAM,KAAK,KAAKhI,GAApB,EAAyB;QACvB,KAAKA,GAAL,GAAW,IAAX;MACD;;MAED,IAAI/L,SAAJ,EAAe;QACb,MAAM0I,GAAG,GAAQ,IAAI3I,KAAJ,CAAU,iCAAV,CAAjB;QACA2I,GAAG,CAAC1I,SAAJ0I,GAAgB,IAAhBA;QACA,MAAMA,GAAN;MACD;;MAED,OAAOX,IAAP;IACD,CAZMoM,CAAP;EAaD;;EAEDxB,cAAc,CAACxK,QAAD,EAAoC;IAChD;IACA,OAAOD,aAAa,CAACC,QAAD,EAAW,IAAX,EAAiB,IAAjB,EAAuB,KAAKoB,GAA5B,EAAiC,KAAjC,CAAbrB,CAAqDR,IAArDQ,CACJkM,UAD6D,IAC9C;MACd,OAAO;QAAErM,IAAI,EAAEqM;MAAR,CAAP;IACD,CAHIlM,CAAP;EAKD;;EAEsB,MAAjBqH,iBAAiB,CAACrF,OAAD,EAQM;IAC3B,MAAM9H,UAAU,GAAG9B,eAAe,CAAC4J,OAAO,CAACvE,EAAT,CAAlC;IACA,MAAMuI,SAAS,GAAGpP,SAAS,CACzBC,WAAW,CAACqD,UAAD,CAAXrD,GAA0BE,WAAW,CAACmD,UAAD,CAArCrD,GAAoDqD,UAD3B,EAEzB8H,OAAO,CAACvJ,MAFiB,CAA3B;IAKA,MAAM0T,GAAG,GAAG,MAAM,KAAKtL,UAAL,CAAgB+F,iBAAhB,EAAlB;IACA,MAAMwF,iBAAiB,GAAGD,GAAG,CAAC/N,IAAJ+N,CAAQ,SAA0B;MAAA,IAA1B,CAAGE,UAAH,EAAeC,KAAf,CAA0B;MAC1D,OAAM,IAAC5R,aAAD,EAAgBA,eAAhB,CAAgB,IAAC6R,mBAAD,EAAmBA,kBAAnB,CAAoBF,UAApB,EAA8B,CAAGC,KAAjC,CAAhB,EAAyDtG,SAAzD,CAAN;IACD,CAFyBmG,CAA1B;;IAIA,IAAE,CAAGC,iBAAL,EAAwB;MACtB,OAAO;QAAE7E,IAAI,EAAE;MAAR,CAAP;IACD;;IAED,MAAMiF,aAAa,GAAG7V,SAAS,CAACqL,OAAO,CAACvE,EAAT,EAAauE,OAAO,CAACvJ,MAArB,CAA/B;IAEA,IAAIgU,SAAJ;;IACA,IAAI;MACFA,SAAS,GAAG,MAAM,KAAKC,iBAAL,CAAuB;QACvCF,aADuC;QAEvCG,WAAW,EAAE3K,OAAO,CAACsF,KAFkB;QAGvCnG,SAAS,EAAEa,OAAO,CAACb;MAHoB,CAAvB,CAAlBsL;IAKD,CAND,CAME,OAAOjM,GAAP,EAAY;MACZ;MACA,OAAO;QACL+G,IAAI,EAAE,UADD;QAELG,WAAW,EAAE1F,OAAO,CAACvE;MAFhB,CAAP;IAID;;IAED,IAAIgP,SAAS,CAACG,OAAd,EAAuB;MACrB;MACA;MACA,IAAE,CAAGH,SAAS,CAACG,OAAVH,CAAkBvU,UAAlBuU,CAA6B,GAA7BA,CAAL,EAAwC;QACtC,OAAO;UACLlF,IAAI,EAAE,UADD;UAELG,WAAW,EAAE1F,OAAO,CAACvE;QAFhB,CAAP;MAID;;MACD,MAAM6I,MAAM,OAAG3D,iBAAH,EAAmBA,gBAAnB,CAAmB,IAC7B/J,oBAD6B,EACVA,mBADU,CAE3B/B,WAAW,CAAC4V,SAAS,CAACG,OAAX,CAAX/V,GACIE,WAAW,CAAC0V,SAAS,CAACG,OAAX,CADf/V,GAEI4V,SAAS,CAACG,OAJa,EAK3B,KAAKlU,OALsB,EAM3BP,QANQ,CAAZ;MASA,MAAM0U,UAAU,OAAG3O,uBAAH,EAA0BA,uBAA1B,CAA2BoI,MAAM,CAACnO,QAAlC,CAAhB;MAEA,IAAIgP,WAAJ;MACA,IAAI7J,YAAJ;;MAEA,IAAI0E,OAAO,CAAChE,KAARgE,CAAcjG,QAAdiG,CAAuB6K,UAAvB7K,CAAJ,EAAwC;QACtCmF,WAAW,GAAG,IAAdA;QACA7J,YAAY,GAAGuP,UAAfvP;MACD,CAHD,MAGO;QACLA,YAAY,GAAGS,mBAAmB,CAAC8O,UAAD,EAAa7K,OAAO,CAAChE,KAArB,CAAlCV;;QAEA,IACEA,YAAY,KAAKgJ,MAAM,CAACnO,QAAxBmF,IACA0E,OAAO,CAAChE,KAARgE,CAAcjG,QAAdiG,CAAuB1E,YAAvB0E,CAFF,EAGE;UACAmF,WAAW,GAAG,IAAdA;QACD;MACF;;MAED,OAAO;QACLI,IAAI,EAAE,SADD;QAELxK,MAAM,EAAEuJ,MAAM,CAACnO,QAFV;QAGLgN,QAAQ,EAAEmB,MAHL;QAILa,WAJK;QAKL7J;MALK,CAAP;IAOD;;IAED,IAAImP,SAAS,CAACK,QAAd,EAAwB;MACtB,IAAIL,SAAS,CAACK,QAAVL,CAAmBvU,UAAnBuU,CAA8B,GAA9BA,CAAJ,EAAwC;QACtC,MAAMM,aAAa,OAAG7O,uBAAH,EAA0BA,uBAA1B,CAA0B,IAC3CtF,oBAD2C,EACxBA,mBADwB,CAEzC/B,WAAW,CAAC4V,SAAS,CAACK,QAAX,CAAXjW,GACIE,WAAW,CAAC0V,SAAS,CAACK,QAAX,CADfjW,GAEI4V,SAAS,CAACK,QAJ2B,EAKzC,KAAKpU,OALoC,EAMzCP,QANe,CAAnB;QASA,MAAM;UAAEuB,GAAG,EAAE+N,MAAP;UAAehK,EAAE,EAAE+J;QAAnB,IAA6BhK,YAAY,CAC7C,IAD6C,EAE7CuP,aAF6C,EAG7CA,aAH6C,CAA/C;QAMA,OAAO;UACLxF,IAAI,EAAE,UADD;UAELE,MAFK;UAGLD;QAHK,CAAP;MAKD;;MAED,OAAO;QACLD,IAAI,EAAE,UADD;QAELG,WAAW,EAAE+E,SAAS,CAACK;MAFlB,CAAP;IAID,CA3G0B,CA6G3B;;;IACA,IAAIL,SAAS,CAACO,OAAVP,IAAiB,CAAKA,SAAS,CAACQ,GAApC,EAAyC;MACvC,OAAO;QACL1F,IAAI,EAAE;MADD,CAAP;IAGD;;IAED,OAAO;MACLA,IAAI,EAAE;IADD,CAAP;EAGD;;EAEDmF,iBAAiB,CAAC/R,MAAD,EAIU;IACzB,MAAM;MAAE6R,aAAF;MAAiBG,WAAW,GAAG,KAA/B;MAAsCxL;IAAtC,IAAoDxG,MAA1D;IACA,MAAM;MAAEsB,IAAI,EAAEoE;IAAR,IAAqB,IAAIvG,GAAJ,CAAQ0S,aAAR,EAAuB9N,MAAM,CAAC4B,QAAP5B,CAAgBzC,IAAvC,CAA3B;;IAEA,IACE7E,OAAO,CAACC,GAARD,CAAYsJ,QAAZtJ,KAAyB,YAAzBA,IAAqC,CACpC+J,SADD/J,IAEAuV,WAFAvV,IAGA,KAAKmK,GAAL,CAASlB,QAAT,CAJF,EAKE;MACA,OAAOmF,OAAO,CAAC0H,OAAR1H,CAAgB,KAAKjE,GAAL,CAASlB,QAAT,CAAhBmF,CAAP;IACD;;IAED,OAAOlG,KAAK,CAACkN,aAAD,EAAgB;MAC1B1H,MAAM,EAAE,MADkB;MAE1BvF,WAAW,EAAE,aAFa;MAG1B4N,OAAO,EAAE;QAAE,0BAA0B;MAA5B;IAHiB,CAAhB,CAAL7N,CAKJE,IALIF,CAKEG,GAAF,IAAU;MACb,IAAE,CAAGA,GAAG,CAACC,EAAT,EAAa;QACX,MAAM,IAAI7H,KAAJ,CAAW,6BAAX,CAAN;MACD;;MAED,OAAO;QACLyP,KAAK,EAAE7H,GAAG,CAAC0N,OAAJ1N,CAAY2N,GAAZ3N,CAAgB,oBAAhBA,CADF;QAELqN,QAAQ,EAAErN,GAAG,CAAC0N,OAAJ1N,CAAY2N,GAAZ3N,CAAgB,UAAhBA,CAFL;QAGLuN,OAAO,EAAEvN,GAAG,CAAC0N,OAAJ1N,CAAY4N,GAAZ5N,CAAgB,sBAAhBA,CAHJ;QAILmN,OAAO,EAAEnN,GAAG,CAAC0N,OAAJ1N,CAAY2N,GAAZ3N,CAAgB,sBAAhBA,CAJJ;QAKLwN,GAAG,IAAIxN,GAAG,CAAC0N,OAAJ1N,CAAY2N,GAAZ3N,CAAgB,kBAAhBA;MALF,CAAP;IAOD,CAjBIH,EAkBJE,IAlBIF,CAkBEO,IAAF,IAAW;MACd,IAAI8M,WAAW,IAAI9M,IAAI,CAACyH,KAALzH,KAAe,UAAlC,EAA8C;QAC5C,KAAK0B,GAAL,CAASlB,QAAT,IAAqBR,IAArB;MACD;;MAED,OAAOA,IAAP;IACD,CAxBIP,EAyBJiB,KAzBIjB,CAyBGkB,GAAF,IAAU;MACd,OAAO,KAAKe,GAAL,CAASlB,QAAT,CAAP;MACA,MAAMG,GAAN;IACD,CA5BIlB,CAAP;EA6BD;;EAEDsK,eAAe,CACb5I,SADa,EAEbsM,GAFa,EAGC;IACd,MAAM;MAAEtM,SAAS,EAAEF;IAAb,IAAqB,KAAKmC,UAAL,CAAgB,OAAhB,CAA3B;;IACA,MAAMsK,OAAO,GAAG,KAAKzJ,QAAL,CAAchD,GAAd,CAAhB;;IACAwM,GAAG,CAACC,OAAJD,GAAcC,OAAdD;IACA,OAAM,IAACE,MAAD,EAAoBA,mBAApB,CAA6C1M,GAA7C,EAAkD;MACtDyM,OADsD;MAEtDvM,SAFsD;MAGtDhF,MAAM,EAAE,IAH8C;MAItDsR;IAJsD,CAAlD,CAAN;EAMD;;EAEDvH,kBAAkB,CAACtI,EAAD,EAAaoI,UAAb,EAAgD;IAChE,IAAI,KAAKhC,GAAT,EAAc;MACZlD,MAAM,CAAC6C,MAAP7C,CAAcwF,IAAdxF,CACE,kBADFA,EAEEjJ,sBAAsB,EAFxBiJ,EAGElD,EAHFkD,EAIEkF,UAJFlF;MAMA,KAAKkD,GAAL;MACA,KAAKA,GAAL,GAAW,IAAX;IACD;EACF;;EAEQ,IAAL5J,KAAK,GAAW;IAClB,OAAO,KAAK0H,KAAL,CAAW1H,KAAlB;EACD;;EAEW,IAAR9B,QAAQ,GAAW;IACrB,OAAO,KAAKwJ,KAAL,CAAWxJ,QAAlB;EACD;;EAEQ,IAALgC,KAAK,GAAmB;IAC1B,OAAO,KAAKwH,KAAL,CAAWxH,KAAlB;EACD;;EAES,IAAN4C,MAAM,GAAW;IACnB,OAAO,KAAK4E,KAAL,CAAW5E,MAAlB;EACD;;EAES,IAANtE,MAAM,GAAuB;IAC/B,OAAO,KAAKkJ,KAAL,CAAWlJ,MAAlB;EACD;;EAEa,IAAVyI,UAAU,GAAY;IACxB,OAAO,KAAKS,KAAL,CAAWT,UAAlB;EACD;;EAEY,IAATC,SAAS,GAAY;IACvB,OAAO,KAAKQ,KAAL,CAAWR,SAAlB;EACD;;AA9+CwB;;kBAANR;AAAAA,MAAM,CAyClB6C,MAzCY7C,GAyCN,IAA6B8M,KAA7B,EAAiCzG,OAAjC,EAzCMrG","names":["getDomainLocale","addLocale","delLocale","hasBasePath","addBasePath","delBasePath","isLocalURL","interpolateAs","resolveHref","detectDomainLocale","process","env","__NEXT_I18N_SUPPORT","require","basePath","__NEXT_ROUTER_BASEPATH","buildCancellationError","Object","assign","Error","cancelled","addPathPrefix","path","prefix","startsWith","pathname","pathNoQueryHash","normalizePathTrailingSlash","slice","length","hasPathPrefix","locale","locales","domainLocales","normalizeLocalePath","detectedLocale","detectedDomain","undefined","http","domain","defaultLocale","pathLower","toLowerCase","localeLower","queryIndex","indexOf","hashIndex","substring","url","locationOrigin","getLocationOrigin","resolved","URL","origin","_","route","asPathname","query","interpolatedRoute","dynamicRegex","getRouteRegex","dynamicGroups","groups","dynamicMatches","getRouteMatcher","params","keys","every","param","value","repeat","optional","replaced","Array","isArray","replace","map","segment","encodeURIComponent","join","result","omitParmsFromQuery","filteredQuery","forEach","key","includes","router","href","resolveAs","base","urlAsString","formatWithValidation","urlProtoMatch","match","urlAsStringNoProto","urlParts","split","console","error","normalizedUrl","normalizeRepeatedSlashes","asPath","finalUrl","interpolatedAs","isDynamicRoute","searchParams","searchParamsToUrlQuery","hash","resolvedHref","stripOrigin","prepareUrlAs","as","resolvedAs","hrefHadOrigin","asHadOrigin","preparedUrl","preparedAs","resolveDynamicRoute","pages","cleanPathname","removePathTrailingSlash","denormalizePagePath","some","page","re","test","manualScrollRestoration","__NEXT_SCROLL_RESTORATION","window","history","v","sessionStorage","setItem","removeItem","n","SSG_DATA_NOT_FOUND","Symbol","fetchRetry","attempts","opts","fetch","credentials","then","res","ok","status","json","data","notFound","text","fetchNextData","dataHref","isServerRender","inflightCache","persistCache","cacheKey","location","catch","err","markAssetError","NODE_ENV","Router","initialProps","pageLoader","App","wrapApp","Component","subscription","isFallback","isPreview","isRsc","sdc","sdr","sde","_idx","onPopState","e","state","changeState","getURL","__N","forcedScroll","options","idx","JSON","stringify","x","self","pageXOffset","y","pageYOffset","getItem","parse","parseRelativeUrl","isSsr","_bps","change","shallow","_shallow","components","initial","props","__N_SSG","__N_SSP","__N_RSC","styleSheets","events","autoExportDynamic","__NEXT_DATA__","autoExport","sub","clc","_wrapApp","isLocaleDomain","isReady","gssp","gip","appGip","gsp","search","__NEXT_HAS_REWRITES","hostname","_shouldResolveHref","addEventListener","scrollRestoration","reload","back","push","method","shouldResolveHref","_h","nextState","prevLocale","parsedAs","localePathResult","didNavigate","ref","asNoBasePath","Promise","ST","performance","mark","scroll","routeProps","_inFlightRoute","abortComponentLoad","cleanedAs","localeChange","onlyAHashChange","emit","scrollToHash","set","parsed","rewrites","__rewrites","all","getPageList","getClientBuildManifest","getMiddlewareList","urlIsNew","rewritesResult","resolveRewrites","default","p","externalDest","matchedPage","effect","_preflightRequest","cache","type","newAs","newUrl","destination","routeRegex","routeMatch","shouldInterpolate","missingParams","filter","warn","ref2","routeInfo","getRouteInfo","component","unstable_scriptLoader","scripts","concat","script","handleClientScriptLoad","pageProps","__N_REDIRECT","__N_REDIRECT_BASE_PATH","parsedHref","__N_PREVIEW","notFoundRoute","fetchComponent","statusCode","isValidShallowRoute","shouldScroll","resetScroll","document","documentElement","lang","isError","handleRouteInfoError","loadErrorFail","isAssetError","getInitialProps","gipErr","routeInfoErr","existingRouteInfo","cachedRouteInfo","mod","__next_rsc__","isValidElementType","useStreamedFlightData","getDataHref","ssg","flight","_getData","_getFlightData","__flight__","getProperError","beforePopState","cb","oldUrlNoHash","oldHash","newUrlNoHash","newHash","scrollTo","idEl","getElementById","scrollIntoView","nameEl","getElementsByName","prefetch","effects","_isSsg","isSsg","priority","cancel","handleCancelled","componentResult","loadPage","fn","serialized","fns","requiresPreflight","middleware","isSSR","getMiddlewareRegex","preflightHref","preflight","_getPreflightData","shouldCache","rewrite","fsPathname","redirect","cleanRedirect","refresh","ssr","resolve","headers","get","has","ctx","AppTree","loadGetInitialProps","mitt"],"sources":["../../../../shared/lib/router/router.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}